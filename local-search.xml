<?xml version="1.0" encoding="utf-8"?>
<search>
  
  
  
  <entry>
    <title>Setå’ŒMapåŸºæœ¬ä½¿ç”¨æ–¹æ³•</title>
    <link href="/2021/10/09/Set%E5%92%8CMap%E5%9F%BA%E6%9C%AC%E4%BD%BF%E7%94%A8%E6%96%B9%E6%B3%95/"/>
    <url>/2021/10/09/Set%E5%92%8CMap%E5%9F%BA%E6%9C%AC%E4%BD%BF%E7%94%A8%E6%96%B9%E6%B3%95/</url>
    
    <content type="html"><![CDATA[<h4 id="Map"><a href="#Map" class="headerlink" title="Map"></a>Map</h4><p><code>Map</code> <strong>(æœ‰é“ç¿»è¯‘)</strong> v.æ˜ å°„<br>çš„ç¡®ï¼Œ<code>Map</code> å¼ºè°ƒçš„å°±æ˜¯<strong>å¯¹åº”å…³ç³»</strong><br>è®°ä½ä¸¤ä¸ª<strong>å…³é”®ç‚¹</strong>ï¼š</p><ol><li>æ— åº, ä½†æœ‰ä¸‹æ ‡ä¸”ä¸‹æ ‡å”¯ä¸€</li><li>é”®å€¼å¯¹</li></ol><h5 id="Map-çš„åŸºæœ¬ç”¨æ³•"><a href="#Map-çš„åŸºæœ¬ç”¨æ³•" class="headerlink" title="Map çš„åŸºæœ¬ç”¨æ³•"></a>Map çš„åŸºæœ¬ç”¨æ³•</h5><p>ï¼ˆä¸€ï¼‰åˆ›å»º</p><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs javascript"><span class="hljs-keyword">let</span> m1 = <span class="hljs-keyword">new</span> <span class="hljs-built_in">Map</span>();<br></code></pre></td></tr></table></figure><p>ï¼ˆäºŒï¼‰è®¾ç½® (Map å¯ä¸åƒå¯¹è±¡ï¼Œé”®åªèƒ½æ”¾å­—ç¬¦ï¼ŒMap çš„é”®å¯ä»¥æ˜¯å„ç§ç±»å‹çš„å€¼ï¼ˆåŒ…æ‹¬å¯¹è±¡ï¼‰éƒ½å¯ä»¥å½“ä½œé”®ï¼Œå¦‚æœä½ éœ€è¦â€œé”®å€¼å¯¹â€çš„æ•°æ®ç»“æ„ï¼ŒMap æ¯” Object æ›´åˆé€‚ã€‚)</p><figure class="highlight lasso"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><code class="hljs lasso">m1.<span class="hljs-built_in">set</span>(<span class="hljs-string">&#x27;a1&#x27;</span>, <span class="hljs-string">&#x27;å¸…å¾—ä¹±ä¸ƒå…«ç³Ÿ&#x27;</span>)<br>m1.<span class="hljs-built_in">set</span>(<span class="hljs-string">&#x27;a2&#x27;</span>, <span class="hljs-string">&#x27;å¸…å¾—æ­ªç“œè£‚æ£&#x27;</span>)<br>m1.<span class="hljs-built_in">set</span>(<span class="hljs-string">&#x27;a3&#x27;</span>, <span class="hljs-string">&#x27;å¸…å¾—ä¸€å¡Œç³Šæ¶‚&#x27;</span>)<br>m1.<span class="hljs-built_in">set</span>(() =&gt; &#123; console.<span class="hljs-keyword">log</span>(<span class="hljs-string">&#x27;func&#x27;</span>)&#125;, <span class="hljs-string">&#x27;å°å‘†å‘†èƒ½æ‰¾åˆ°å¥³æœ‹å‹&#x27;</span> )  <span class="hljs-comment">// é”™è¯¯</span><br><span class="hljs-comment">// å¯¹äºé™¤äº†å­—ç¬¦ä¸²ç±»å‹ï¼Œæœ€å¥½æ˜¯èµ‹å€¼åˆ°ä¸€ä¸ªå˜é‡åå†æ”¾å…¥seté‡Œé¢å»</span><br><span class="hljs-keyword">let</span> b = () =&gt; &#123; console.<span class="hljs-keyword">log</span>(<span class="hljs-string">&#x27;func&#x27;</span>)&#125;;<br>m1.<span class="hljs-built_in">set</span>(b, <span class="hljs-string">&#x27;å°å‘†å‘†èƒ½æ‰¾åˆ°å¥³æœ‹å‹&#x27;</span>)<br></code></pre></td></tr></table></figure><p>ï¼ˆä¸‰ï¼‰è·å–</p><figure class="highlight livecodeserver"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><code class="hljs livecodeserver">console.<span class="hljs-built_in">log</span>(m1.<span class="hljs-built_in">get</span>(<span class="hljs-string">&#x27;a2&#x27;</span>));   <span class="hljs-comment"> // å¸…å¾—æ­ªç“œè£‚æ£</span><br>console.<span class="hljs-built_in">log</span>(m1.<span class="hljs-built_in">get</span>(b));      <span class="hljs-comment"> // &#x27;å°å‘†å‘†èƒ½æ‰¾åˆ°å¥³æœ‹å‹&#x27;</span><br></code></pre></td></tr></table></figure><p>ï¼ˆå››ï¼‰åˆ¤æ–­ â€”&gt; åªèƒ½æ”¾å…¥é”®</p><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><code class="hljs sql">console.<span class="hljs-built_in">log</span>(m1.has(<span class="hljs-string">&#x27;a2&#x27;</span>));         <span class="hljs-operator">/</span><span class="hljs-operator">/</span> <span class="hljs-literal">true</span><br>console.<span class="hljs-built_in">log</span>(m1.has(<span class="hljs-string">&#x27;å¸…å¾—ä¸€å¡Œç³Šæ¶‚&#x27;</span>)); <span class="hljs-operator">/</span><span class="hljs-operator">/</span> <span class="hljs-literal">false</span><br></code></pre></td></tr></table></figure><p>ï¼ˆäº”ï¼‰åˆ é™¤</p><figure class="highlight awk"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><code class="hljs awk">m1.<span class="hljs-keyword">delete</span>(<span class="hljs-string">&#x27;a3&#x27;</span>)<br>console.log(m1.has(<span class="hljs-string">&#x27;a3&#x27;</span>));  <span class="hljs-regexp">//</span> false<br></code></pre></td></tr></table></figure><p>ï¼ˆå…­ï¼‰æ¸…ç©º</p><figure class="highlight arduino"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><code class="hljs arduino">m1.<span class="hljs-built_in">clear</span>();<br>console.<span class="hljs-built_in">log</span>(m1)<br></code></pre></td></tr></table></figure><p>ï¼ˆä¸ƒï¼‰é”®å€¼å¯¹ä¸ªæ•°</p><figure class="highlight processing"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><code class="hljs processing">m1.<span class="hljs-built_in">set</span>(<span class="hljs-string">&#x27;a1&#x27;</span>, <span class="hljs-string">&#x27;å¸…å¾—ä¹±ä¸ƒå…«ç³Ÿ&#x27;</span>)<br>m1.<span class="hljs-built_in">set</span>(<span class="hljs-string">&#x27;a2&#x27;</span>, <span class="hljs-string">&#x27;å¸…å¾—æ­ªç“œè£‚æ£&#x27;</span>)<br>m1.<span class="hljs-built_in">set</span>(<span class="hljs-string">&#x27;a3&#x27;</span>, <span class="hljs-string">&#x27;å¸…å¾—ä¸€å¡Œç³Šæ¶‚&#x27;</span>)<br>console.<span class="hljs-built_in">log</span>(m1.<span class="hljs-built_in">size</span>)   <span class="hljs-comment">// 3</span><br></code></pre></td></tr></table></figure><p><strong>å†æ¬¡å¼ºè°ƒï¼ï¼</strong> <code>Map</code> æ¯” <code>å¯¹è±¡</code>å¼ºçš„åœ°æ–¹åœ¨äº <code>Map</code> çš„ä¸‹æ ‡(é”®)æ¯”<code>å¯¹è±¡</code>çš„é”®æ›´çµæ´»ï¼Œå¯ä»¥æ˜¯ä»»ä½•ç±»å‹!</p><p>ï¼ˆå…«ï¼‰éå† Map (æ³¨æ„ï¼šéå†å…¶å®å°±æ˜¯è¿­ä»£)</p><figure class="highlight pgsql"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs pgsql">m1.<span class="hljs-keyword">forEach</span>((item, <span class="hljs-keyword">index</span>) =&gt; console.log(item, <span class="hljs-keyword">index</span>))   //itemåªä¼šæ˜¾ç¤ºå€¼ä¸ä¼šæ˜¾ç¤ºé”®è€Œ <span class="hljs-keyword">index</span> ä¼šæ˜¾ç¤ºå‡ºé”®ï¼Œä¸ä¼šæ˜¾ç¤ºå€¼<br></code></pre></td></tr></table></figure><hr><h4 id="éå†"><a href="#éå†" class="headerlink" title="éå†"></a>éå†</h4><blockquote><p>å·§è®°ï¼š forâ€¦of(éå†æ•°ç»„) forâ€¦in(éå†å¯¹è±¡)</p></blockquote><p>äº‹å®ä¸Šæœ€å¥½åˆ«æ‹¿ forâ€¦in æ¥éå†æ•°ç»„(forâ€¦of åŒç†ï¼Œåˆ«æ‹¿æ¥éå†å¯¹è±¡)</p><figure class="highlight awk"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br></pre></td><td class="code"><pre><code class="hljs awk">let arr = [<span class="hljs-number">1</span>, <span class="hljs-number">2</span>, <span class="hljs-number">3</span>];<br>arr.name = <span class="hljs-string">&#x27;æˆ‘æ˜¯è°&#x27;</span>;    <span class="hljs-regexp">//</span> å¦‚æœæœ‰äººè„‘æ®‹ï¼Œåœ¨arrä¸­åˆä»¥è¿™æ ·çš„æ–¹å¼å¢æ·»äº†å±æ€§<br><br><span class="hljs-keyword">for</span> (let key <span class="hljs-keyword">in</span> arr) &#123;<br>  console.log(key);   <span class="hljs-regexp">//</span> ä¸ä»…arrä¸‹æ ‡æ‰“å°è¿˜ä¼šæŠŠnameä¹Ÿéå†äº†...<br>&#125;<br><br><span class="hljs-keyword">for</span> (let key of arr) &#123;<br>  <span class="hljs-regexp">//</span> <span class="hljs-keyword">for</span> of ç›¸è¾ƒäº forEach map è¿™äº›æ–¹æ³• èƒ½å¤Ÿæœ‰ä¸­æ–­éå†åŠŸèƒ½<br>  <span class="hljs-regexp">//</span> <span class="hljs-keyword">break</span>;<br>  console.log(key);   <span class="hljs-regexp">//</span> ä¼šéå†çœŸæ­£çš„æ•°ç»„å…ƒç´ ã€‚name ä¸ä¼šéå†<br>&#125;<br>let obj = &#123;<br>  name: <span class="hljs-string">&#x27;å°æ˜&#x27;</span>,<br>  sex: <span class="hljs-string">&#x27;ç”·&#x27;</span>,<br>  age: <span class="hljs-number">19</span><br>&#125;<br><br><span class="hljs-regexp">//</span> éå†å¯¹è±¡<br><span class="hljs-keyword">for</span> (let k <span class="hljs-keyword">in</span> obj) &#123;<br>  <span class="hljs-regexp">//</span> å¦‚æœæ˜¯obj.k ä»¥ä¸ºæ˜¯objçš„kå±æ€§ã€‚ä½†æ²¡æœ‰åœ¨objé‡Œè®¾ç½®k<br>  <span class="hljs-regexp">//</span> ä½†è¦æ³¨æ„ï¼šå¦‚æœæ˜¯obj[k] kä¼šè¢«å½“æˆå­—ç¬¦ä¸²çš„å±æ€§ ä¾‹å¦‚ obj[<span class="hljs-string">&#x27;key&#x27;</span>]<br>  console.log(k, obj[k]);<br>&#125;<br><br>console.log(obj[<span class="hljs-string">&#x27;name&#x27;</span>]);   <span class="hljs-regexp">//</span> å°æ˜<br></code></pre></td></tr></table></figure><hr><h4 id="Set"><a href="#Set" class="headerlink" title="Set"></a>Set</h4><p>**Set å®¹å™¨(é›†åˆ)**ï¼šæ— åº ä¸å¯é‡å¤çš„å¤šä¸ª value çš„é›†åˆä½“(ä¸æ˜¯é”®å€¼å¯¹å“¦ï¼)<br>ç†è§£ä¸ºç‰¹æ®Šæ•°ç»„ï¼Œå…ƒç´ å€¼ä¸é‡å¤</p><p>å…¶å®å’Œä¸Šé¢çš„ Map çš„æ–¹æ³•ä¸€æ ·, æ— å¤–ä¹å¢åˆ æ”¹æŸ¥</p><figure class="highlight processing"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><code class="hljs processing"><span class="hljs-comment">// åˆ›å»ºä¸€ä¸ªç©ºé›†åˆ</span><br>let set1 = <span class="hljs-keyword">new</span> Set();<br><br><span class="hljs-comment">// æ·»åŠ å…ƒç´ </span><br>set1.<span class="hljs-built_in">add</span>(<span class="hljs-string">&#x27;a&#x27;</span>)<br>set1.<span class="hljs-built_in">add</span>(<span class="hljs-string">&#x27;c&#x27;</span>)<br><br>console.<span class="hljs-built_in">log</span>(set1);<br>console.<span class="hljs-built_in">log</span>(set1.has(<span class="hljs-string">&#x27;b&#x27;</span>));  <span class="hljs-comment">// é›†åˆä¸­æ˜¯å¦å«æœ‰ &#x27;b&#x27;</span><br>set1.delete(<span class="hljs-string">&#x27;c&#x27;</span>);    <span class="hljs-comment">// åˆ é™¤ &#x27;c&#x27;</span><br>set1.<span class="hljs-built_in">add</span>(<span class="hljs-string">&#x27;a&#x27;</span>);       <span class="hljs-comment">// å› ä¸ºé‡å¤ï¼Œæ‰€ä»¥åªä¿ç•™ä¸€ä¸ª</span><br>console.<span class="hljs-built_in">log</span>(set1);<br>console.<span class="hljs-built_in">log</span>(set1.<span class="hljs-built_in">size</span>);   <span class="hljs-comment">// å…ƒç´ ä¸ªæ•°</span><br>set1.<span class="hljs-built_in">clear</span>();        <span class="hljs-comment">// æ¸…ç©ºé›†åˆ</span><br>console.<span class="hljs-built_in">log</span>(set1);<br></code></pre></td></tr></table></figure>]]></content>
    
    
    <categories>
      
      <category>JavaScript</category>
      
    </categories>
    
    
    <tags>
      
      <tag>å‰ç«¯</tag>
      
    </tags>
    
  </entry>
  
  
  
  <entry>
    <title>æµ…æ‹·è´å’Œæ·±æ‹·è´</title>
    <link href="/2021/10/08/%E6%B5%85%E6%8B%B7%E8%B4%9D%E5%92%8C%E6%B7%B1%E6%8B%B7%E8%B4%9D/"/>
    <url>/2021/10/08/%E6%B5%85%E6%8B%B7%E8%B4%9D%E5%92%8C%E6%B7%B1%E6%8B%B7%E8%B4%9D/</url>
    
    <content type="html"><![CDATA[<blockquote><p>å‰ç½®çŸ¥è¯†ï¼šå€¼èµ‹å€¼å’Œå¼•ç”¨èµ‹å€¼å°±ä¸å†èµ˜è¿°äº†, ç›¸å¯¹è€Œè¨€æŒºåŸºç¡€çš„â€¦</p></blockquote><p>æˆ‘å·²çŸ¥çš„èƒ½å¤Ÿåœ¨<code>js</code>é‡Œå®ç°<code>æ‹·è´</code>çš„ 3 ç§ç°æˆæ–¹æ³• ğŸ§</p><h4 id="3-ç§ç°æˆçš„å®ç°æ‹·è´çš„æ–¹æ³•"><a href="#3-ç§ç°æˆçš„å®ç°æ‹·è´çš„æ–¹æ³•" class="headerlink" title="3 ç§ç°æˆçš„å®ç°æ‹·è´çš„æ–¹æ³•"></a>3 ç§ç°æˆçš„å®ç°æ‹·è´çš„æ–¹æ³•</h4><h5 id="1-JSON-å¤§æ³•"><a href="#1-JSON-å¤§æ³•" class="headerlink" title="1. JSON å¤§æ³•"></a>1. JSON å¤§æ³•</h5><figure class="highlight awk"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><code class="hljs awk"><span class="hljs-regexp">//</span> jsonå¤§æ³•<br>/**<br> * ä¼˜ç‚¹ï¼šæœ€ç®€å•çš„å®ç°æ·±æ‹·è´çš„æ–¹å¼<br> * ç¼ºç‚¹ï¼š<br> * æ”¯æŒçš„æ•°æ®ç±»å‹ï¼šString<span class="hljs-regexp">/Number/</span>Boolean<span class="hljs-regexp">/Object/</span>Array/null<br> * ä¸æ”¯æŒçš„ç±»å‹ï¼š undefined<span class="hljs-regexp">/Symbol/</span>å¾ªç¯å¼•ç”¨<span class="hljs-regexp">/å‡½æ•°/</span>Date/RegExp<br> */<br><br> const obj1 = &#123;a: <span class="hljs-number">100</span>, b: &#123;key: <span class="hljs-string">&#x27;123&#x27;</span>&#125;&#125;<br> const obj2 = JSON.parse(JSON.stringify(obj1))<br>console.log(obj1 === obj2) <span class="hljs-regexp">//</span> false<br> ä¸ªäººè¯„ä»·ï¼šäº‹å®ä¸Šï¼Œ<span class="hljs-number">90</span>%çš„æƒ…å†µä¸‹ï¼Œä¸Šè¿°æ–¹æ³•å·²ç»å¤Ÿç”¨äº†ï¼Œä¸€èˆ¬ä¸æ”¯æŒçš„ç±»å‹è¿™ç§ç”¨å¾—å°‘...<br></code></pre></td></tr></table></figure><h5 id="2-Object-assign-â€“-gt-æµ…æ‹·è´"><a href="#2-Object-assign-â€“-gt-æµ…æ‹·è´" class="headerlink" title="2.Object.assign() â€“&gt; æµ…æ‹·è´"></a>2.Object.assign() â€“&gt; æµ…æ‹·è´</h5><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><code class="hljs javascript"><span class="hljs-keyword">var</span> obj3 = &#123;<span class="hljs-attr">name</span>: <span class="hljs-string">&#x27;å°æ˜&#x27;</span>, <span class="hljs-attr">sorce</span>: [<span class="hljs-number">88</span>, <span class="hljs-number">100</span>]&#125;<br><span class="hljs-keyword">var</span> obj4 = <span class="hljs-built_in">Object</span>.assign(&#123;&#125;, obj3)  <span class="hljs-comment">// obj1 ä¸ &#123;&#125; åˆå¹¶ï¼Œ å†…éƒ¨çš„å¼•ç”¨è¿˜æ˜¯ä¸€æ ·çš„</span><br><span class="hljs-built_in">console</span>.log(obj3 === obj4) <span class="hljs-comment">// false</span><br><br>ä¸ªäººè¯„ä»·ï¼š ç”¨æ³•æ–¹ä¾¿ç®€å•ï¼Œä½†æ˜¯æ³¨æ„æ˜¯æµ…æ‹·è´ï¼Œåœ¨åšä¸€äº›é¡¹ç›®çš„æ—¶å€™ï¼Œéœ€è¦æœ‰æ¸…æ™°çš„è„‘è¢‹çŸ¥é“è‡ªå·±æ˜¯åœ¨åšæ·±æ‹·è´è¿˜æ˜¯æµ…æ‹·è´<br></code></pre></td></tr></table></figure><h5 id="3-Lodash-åº“"><a href="#3-Lodash-åº“" class="headerlink" title="3.Lodash åº“"></a>3.Lodash åº“</h5><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><code class="hljs javascript"><span class="hljs-comment">// _.clone     æµ…æ‹·è´</span><br><span class="hljs-comment">// _.deepclone æ·±æ‹·è´</span><br><span class="hljs-keyword">var</span> obj5 = &#123; <span class="hljs-attr">name</span>: <span class="hljs-string">&#x27;å°æ˜&#x27;</span>, <span class="hljs-attr">sorce</span>: [<span class="hljs-number">88</span>, <span class="hljs-number">100</span>]&#125;<br><span class="hljs-keyword">var</span> obj6 = _.cloneDeep(obj5);<br><span class="hljs-built_in">console</span>.log(obj5 === obj6)<br><br>ä¸ªäººè¯„ä»·ï¼š ä¸ç”¨è¯´ï¼Œç‰›é€¼ï¼<br></code></pre></td></tr></table></figure><hr><h4 id="æ·±æ‹·è´å®ç°"><a href="#æ·±æ‹·è´å®ç°" class="headerlink" title="æ·±æ‹·è´å®ç°"></a>æ·±æ‹·è´å®ç°</h4><h5 id="æœ¬å¥—æ·±æ‹·è´å®ç°æ–¹æ³•å‰ç½®çŸ¥è¯†"><a href="#æœ¬å¥—æ·±æ‹·è´å®ç°æ–¹æ³•å‰ç½®çŸ¥è¯†" class="headerlink" title="æœ¬å¥—æ·±æ‹·è´å®ç°æ–¹æ³•å‰ç½®çŸ¥è¯†"></a>æœ¬å¥—æ·±æ‹·è´å®ç°æ–¹æ³•å‰ç½®çŸ¥è¯†</h5><figure class="highlight awk"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br></pre></td><td class="code"><pre><code class="hljs awk"><span class="hljs-regexp">//</span> obj1 ä¸ºä¸€ä¸ªæ™®é€šå¯¹è±¡<br>let obj1 = &#123;<br> name: <span class="hljs-string">&#x27;å¼ ä¸‰&#x27;</span>,<br> sex: <span class="hljs-string">&#x27;ç”·&#x27;</span>,<br> age: <span class="hljs-number">18</span>,<br> friends: [<span class="hljs-string">&#x27;å°æ˜&#x27;</span>, <span class="hljs-string">&#x27;å°ç‰&#x27;</span>, <span class="hljs-string">&#x27;å°èŒ&#x27;</span>]<br>&#125;<br><br><span class="hljs-regexp">//</span> åˆ›å»ºä¸€ä¸ªç©ºå¯¹è±¡ obj2<br>let obj2 = &#123;&#125;<br><span class="hljs-regexp">//</span> ä¾æ¬¡å°†obj1å¯¹è±¡é‡Œçš„å±æ€§èµ‹å€¼åˆ°obj2é‡Œ(æ³¨æ„ï¼Œè¦åˆ¤æ–­obj1é‡Œçš„å±æ€§æ˜¯æ™®é€šç±»å‹(å€¼ç±»å‹)è¿˜æ˜¯å¼•ç”¨ç±»å‹)<br><span class="hljs-regexp">//</span> å€¼ç±»å‹ ç›´æ¥å¤åˆ¶ã€‚å¦‚æœæ˜¯å¼•ç”¨ç±»å‹è¿˜éœ€è¦å†æ·±å±‚è¿›å…¥å¼•ç”¨ç±»å‹ä¸­æ‰¾åˆ°äººå®¶çš„å€¼ç±»å‹(é€’å½’å¤§æ³•)<br>obj2.name = obj1.name   <span class="hljs-regexp">//</span> æ˜¯å¦ä¸ºæ™®é€šç±»å‹<br>obj2.sex = obj1.sex     <span class="hljs-regexp">//</span> æ˜¯å¦ä¸ºæ™®é€šç±»å‹<br>obj2.age = obj1.age     <span class="hljs-regexp">//</span> æ˜¯å¦ä¸ºæ™®é€šç±»å‹<br>obj2.friends = obj1friends <span class="hljs-regexp">//</span> éå†å¾ªç¯obj1friendsã€‚è¿”å›æ–°çš„friends<br><br></code></pre></td></tr></table></figure><figure class="highlight awk"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br></pre></td><td class="code"><pre><code class="hljs awk">/**<br> * æ•°æ®ç±»å‹<br> *<br> * typeof <span class="hljs-number">1</span>      <span class="hljs-regexp">//</span> <span class="hljs-string">&quot;number&quot;</span><br> * typeof <span class="hljs-string">&quot;a&quot;</span>    <span class="hljs-regexp">//</span> <span class="hljs-string">&quot;string&quot;</span><br> * typeof true   <span class="hljs-regexp">//</span> <span class="hljs-string">&quot;boolean&quot;</span><br> * typeof &#123;&#125;     <span class="hljs-regexp">//</span> <span class="hljs-string">&quot;object&quot;</span><br> * typeof []     <span class="hljs-regexp">//</span> <span class="hljs-string">&quot;object&quot;</span><br> * typeof null   <span class="hljs-regexp">//</span> <span class="hljs-string">&quot;object&quot;</span>   &lt;---  è¿™é‡Œå®¹æ˜“äº§ç”Ÿè¯¯ä¼š<br> * typeof undefined      <span class="hljs-regexp">//</span> <span class="hljs-string">&quot;undefined&quot;</span><br> * typeof <span class="hljs-keyword">function</span>()&#123;&#125;   <span class="hljs-regexp">//</span> <span class="hljs-string">&quot;function&quot;</span><br> * typeof Symbol()       <span class="hljs-regexp">//</span> <span class="hljs-string">&quot;symbol&quot;</span><br> *<br> *<br> * Object.prototype.toString.call(<span class="hljs-number">1</span>)         <span class="hljs-regexp">//</span> <span class="hljs-string">&#x27;[object Number]&#x27;</span><br> * Object.prototype.toString.call(<span class="hljs-string">&#x27;a&#x27;</span>)       <span class="hljs-regexp">//</span> <span class="hljs-string">&#x27;[object String]&#x27;</span><br> * Object.prototype.toString.call(true)      <span class="hljs-regexp">//</span> <span class="hljs-string">&#x27;[object Boolean]&#x27;</span><br> * Object.prototype.toString.call(&#123;&#125;)        <span class="hljs-regexp">//</span> <span class="hljs-string">&#x27;[object Object]&#x27;</span><br> * Object.prototype.toString.call([])        <span class="hljs-regexp">//</span> <span class="hljs-string">&#x27;[object Array]&#x27;</span><br> * Object.prototype.toString.call(null)      <span class="hljs-regexp">//</span> <span class="hljs-string">&#x27;[object Null]&#x27;</span><br> * Object.prototype.toString.call(<span class="hljs-regexp">/a/</span>)       <span class="hljs-regexp">//</span> <span class="hljs-string">&#x27;[object RegExp]&#x27;</span><br> * Object.prototype.toString.call(undefined) <span class="hljs-regexp">//</span> <span class="hljs-string">&#x27;[object Undefined]&#x27;</span><br> * Object.prototype.toString.call(<span class="hljs-keyword">function</span>()&#123;&#125;)  <span class="hljs-regexp">//</span> <span class="hljs-string">&#x27;[object Function]&#x27;</span><br> * Object.prototype.toString.call(new Date())    <span class="hljs-regexp">//</span> <span class="hljs-string">&#x27;[object Date]&#x27;</span><br> */<br></code></pre></td></tr></table></figure><h5 id="å¼€å§‹å®ç°æ·±æ‹·è´"><a href="#å¼€å§‹å®ç°æ·±æ‹·è´" class="headerlink" title="å¼€å§‹å®ç°æ·±æ‹·è´"></a>å¼€å§‹å®ç°æ·±æ‹·è´</h5><figure class="highlight typescript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br></pre></td><td class="code"><pre><code class="hljs typescript"><span class="hljs-keyword">const</span> deepClone = <span class="hljs-function">(<span class="hljs-params">src</span>) =&gt;</span> &#123;<br>  <span class="hljs-keyword">let</span> <span class="hljs-keyword">type</span> = <span class="hljs-built_in">Object</span>.prototype.toString.call(src).slice(<span class="hljs-number">8</span>, -<span class="hljs-number">1</span>);<br>  <span class="hljs-keyword">let</span> dist = <span class="hljs-literal">null</span>;<br>  <span class="hljs-keyword">if</span> (<span class="hljs-keyword">type</span> === <span class="hljs-string">&#x27;Number&#x27;</span>) &#123;<br>    <span class="hljs-keyword">return</span> src;<br>  &#125; <span class="hljs-keyword">else</span> <span class="hljs-keyword">if</span> (<span class="hljs-keyword">type</span> === <span class="hljs-string">&#x27;String&#x27;</span>) &#123;<br>    <span class="hljs-keyword">return</span> src;<br>  &#125; <span class="hljs-keyword">else</span> <span class="hljs-keyword">if</span> (<span class="hljs-keyword">type</span> === <span class="hljs-string">&#x27;Boolean&#x27;</span>) &#123;<br>    <span class="hljs-keyword">return</span> src;<br>  &#125; <span class="hljs-keyword">else</span> <span class="hljs-keyword">if</span> (<span class="hljs-keyword">type</span> === <span class="hljs-string">&#x27;Object&#x27;</span>) &#123;<br>    dist = &#123;&#125;<br>  &#125; <span class="hljs-keyword">else</span> <span class="hljs-keyword">if</span> (<span class="hljs-keyword">type</span> === <span class="hljs-string">&#x27;Array&#x27;</span>) &#123;<br>    dist = []<br>  &#125; <span class="hljs-keyword">else</span> <span class="hljs-keyword">if</span> (<span class="hljs-keyword">type</span> === <span class="hljs-string">&#x27;Function&#x27;</span>) &#123;<br>    <span class="hljs-comment">// ... è¿™ä¸ªæŒºæœ‰å›°æƒ‘çš„</span><br>    dist = src.bind(<span class="hljs-built_in">this</span>);   <span class="hljs-comment">// ç”Ÿæˆäº†ä¸€ä¸ªæ–°çš„å‡½æ•°ï¼ŒthisæŒ‡å‘çš„æ˜¯ä»€ä¹ˆ</span><br>  &#125;<br><br>  <span class="hljs-keyword">for</span> (<span class="hljs-keyword">let</span> key <span class="hljs-keyword">in</span> src) &#123;<br>    dist[key] = deepClone(src[key]);<br>  &#125;<br>  <span class="hljs-keyword">return</span> dist;<br>&#125;<br><br><span class="hljs-keyword">let</span> obj1 = &#123;<br>  <span class="hljs-attr">a</span>: <span class="hljs-string">&#x27;100&#x27;</span>,<br>  <span class="hljs-attr">b</span>: <span class="hljs-string">&#x27;200&#x27;</span>,<br>  <span class="hljs-attr">c</span>: &#123;<span class="hljs-attr">d</span>: <span class="hljs-string">&#x27;300&#x27;</span>, <span class="hljs-attr">e</span>: &#123;<span class="hljs-attr">f</span>: <span class="hljs-string">&#x27;500&#x27;</span>&#125;&#125;,<br>  <span class="hljs-attr">fn</span>: <span class="hljs-function">() =&gt;</span> &#123;<span class="hljs-built_in">console</span>.log(<span class="hljs-string">&#x27;this is a function&#x27;</span>)&#125;<br>&#125;<br><br><span class="hljs-keyword">let</span> obj2 = deepClone(obj1);<br><span class="hljs-built_in">console</span>.log(<span class="hljs-string">&#x27;obj1 === obj2 ?&#x27;</span>, obj1 === obj2);<br><span class="hljs-built_in">console</span>.log(<span class="hljs-string">&#x27;obj2&#x27;</span>, obj2);<br><br></code></pre></td></tr></table></figure><head>  ..  <script src="//cdn.jsdelivr.net/npm/@waline/client"></script>  ...</head><body>  ...  <div id="waline"></div>  <script>    Waline({      el: '#waline',       avatar: 'monsterid',      serverURL: 'https://blog-api-9sizcti78-bruce-shuai.vercel.app/',    });  </script></body>]]></content>
    
    
    <categories>
      
      <category>JavaScript</category>
      
    </categories>
    
    
    <tags>
      
      <tag>å‰ç«¯</tag>
      
    </tags>
    
  </entry>
  
  
  
  <entry>
    <title>JSON åŸºç¡€çŸ¥è¯† &amp; Ajax åŸºç¡€çŸ¥è¯†</title>
    <link href="/2021/10/08/JSON&amp;Ajax%E5%9F%BA%E7%A1%80%E7%9F%A5%E8%AF%86/"/>
    <url>/2021/10/08/JSON&amp;Ajax%E5%9F%BA%E7%A1%80%E7%9F%A5%E8%AF%86/</url>
    
    <content type="html"><![CDATA[<h4 id="ä¸ºä»€ä¹ˆæˆ‘ä»¬è¦æŠŠå¯¹è±¡è½¬åŒ–ä¸ºå­—ç¬¦ä¸²ï¼Ÿ"><a href="#ä¸ºä»€ä¹ˆæˆ‘ä»¬è¦æŠŠå¯¹è±¡è½¬åŒ–ä¸ºå­—ç¬¦ä¸²ï¼Ÿ" class="headerlink" title="ä¸ºä»€ä¹ˆæˆ‘ä»¬è¦æŠŠå¯¹è±¡è½¬åŒ–ä¸ºå­—ç¬¦ä¸²ï¼Ÿ"></a>ä¸ºä»€ä¹ˆæˆ‘ä»¬è¦æŠŠå¯¹è±¡è½¬åŒ–ä¸ºå­—ç¬¦ä¸²ï¼Ÿ</h4><ol><li><p>åœ¨ç½‘é¡µå¼€å‘çš„æ—¶å€™ï¼Œæˆ‘ä»¬éœ€è¦æŠŠ<code>å¯¹è±¡ä¿¡æ¯</code>è¿›è¡Œé•¿æœŸä¿å­˜, å› æ­¤æˆ‘ä»¬éœ€è¦æŠŠè¿™äº›ä¿¡æ¯ä¼ é€’ç»™<code>æœåŠ¡å™¨</code>ã€‚æ‰€ä»¥ï¼Œéœ€è¦é€šè¿‡æŠŠå¯¹è±¡(å˜é‡)è½¬åŒ–ä¸ºå­—ç¬¦ä¸²æ‰èƒ½ä¼ é€’ç»™<code>æœåŠ¡å™¨</code>ã€‚</p></li><li><p>æˆ‘ä»¬é‡‡ç”¨çš„æ˜¯<code>httpåè®®</code>å³è¶…æ–‡æœ¬ä¼ è¾“åè®®(å…¶æœ¬è´¨å°±æ˜¯ç”±æ–‡æœ¬çš„å½¢å¼è¿›è¡Œä¼ è¾“)</p></li><li><p>JSON å­—ç¬¦ä¸²æ˜¯ç»å¤§å¤šæ•°ç¼–ç¨‹è¯­è¨€éƒ½æ”¯æŒçš„â€¦</p></li></ol><h4 id="JSON-å­—ç¬¦ä¸²çš„ç‰¹å¾"><a href="#JSON-å­—ç¬¦ä¸²çš„ç‰¹å¾" class="headerlink" title="JSON å­—ç¬¦ä¸²çš„ç‰¹å¾"></a>JSON å­—ç¬¦ä¸²çš„ç‰¹å¾</h4><ol><li><strong>å±æ€§åç§°</strong>å¿…é¡»åŠ <strong>åŒå¼•å·</strong> (å› ä¸ºäººå®¶é»˜è®¤è§„å®šçš„å­—ç¬¦ä¸²å¤–å±‚æ˜¯<code>å•å¼•å·</code>ï¼Œæ‰€ä»¥å†…å±‚å¿…é¡»æ˜¯<code>åŒå¼•å·</code>)</li><li><strong>å±æ€§å€¼</strong>å¦‚æœæ˜¯å­—ç¬¦ä¸²åˆ™å¿…é¡»åŠ <strong>åŒå¼•å·</strong></li><li>å¯¹è±¡å½“ä¸­çš„<code>æ–¹æ³•(å‡½æ•°)</code>ä¸ä¼šè¢«è½¬åŒ–ä¸ºå­—ç¬¦ä¸²</li></ol><p>(æ³¨æ„ï¼š JSON æœ¬è´¨å°±æ˜¯å­—ç¬¦ä¸²ï¼ï¼)</p><h4 id="JSON-å’Œ-å¯¹è±¡çš„ç›¸äº’è½¬æ¢ï¼š"><a href="#JSON-å’Œ-å¯¹è±¡çš„ç›¸äº’è½¬æ¢ï¼š" class="headerlink" title="JSON å’Œ å¯¹è±¡çš„ç›¸äº’è½¬æ¢ï¼š"></a>JSON å’Œ å¯¹è±¡çš„ç›¸äº’è½¬æ¢ï¼š</h4><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br></pre></td><td class="code"><pre><code class="hljs javascript"><span class="hljs-keyword">let</span> obj = &#123;<br>  <span class="hljs-attr">name</span>: <span class="hljs-string">&#x27;xiaoming&#x27;</span>,<br>  <span class="hljs-attr">sex</span>: <span class="hljs-string">&#x27;boy&#x27;</span>,<br>  <span class="hljs-attr">age</span>: <span class="hljs-number">18</span>,<br>  <span class="hljs-function"><span class="hljs-title">say</span>(<span class="hljs-params"></span>)</span> &#123;<br>    <span class="hljs-built_in">console</span>.log(<span class="hljs-string">&#x27;æƒ³åƒ, æƒ³å–, æƒ³çˆ±&#x27;</span>)<br>  &#125;<br>&#125;<br><br><span class="hljs-comment">// æŠŠå¯¹è±¡è½¬ä¸ºJSONå­—ç¬¦ä¸²</span><br><span class="hljs-keyword">let</span> str1 = <span class="hljs-built_in">JSON</span>.stringify(obj);<br><span class="hljs-built_in">console</span>.log(<span class="hljs-string">&#x27;obj&#x27;</span>, obj);<br><span class="hljs-built_in">console</span>.log(<span class="hljs-string">&#x27;str1&#x27;</span>, str1);   <span class="hljs-comment">// çº¯ç²¹çš„å­—ç¬¦ä¸²ä¸”æ²¡æœ‰sayæ–¹æ³•</span><br><br><span class="hljs-comment">// æŠŠæ•°ç»„è½¬ä¸ºJSONå­—ç¬¦ä¸²</span><br><span class="hljs-keyword">let</span> arr = [<span class="hljs-string">&#x27;a&#x27;</span>, <span class="hljs-string">&#x27;b&#x27;</span>, <span class="hljs-string">&#x27;c&#x27;</span>, <span class="hljs-number">100</span>, &#123;<span class="hljs-attr">key</span>: <span class="hljs-number">100</span>, <span class="hljs-attr">obj</span>: &#123;&#125;, <span class="hljs-attr">str</span>: <span class="hljs-string">&#x27;æµ‹è¯•&#x27;</span>&#125;]<br><span class="hljs-keyword">let</span> str2 = <span class="hljs-built_in">JSON</span>.stringify(arr);<br><span class="hljs-built_in">console</span>.log(<span class="hljs-string">&#x27;arr&#x27;</span>, arr);<br><span class="hljs-comment">// å†…éƒ¨çš„å­—ç¬¦ä¸²å…ƒç´ å…¨éƒ¨è¢«å¼ºåˆ¶è½¬åŒ–ä¸ºåŒå¼•å·,æ•°å€¼ä¸åŠ å¼•å·ï¼Œ</span><br><span class="hljs-comment">// å¯¹è±¡å…ƒç´ è¿›è¡Œæ·±å±‚æ”¹é€ (åŠ åŒå¼•å·..),è€Œä¸”ä¸å†æ˜¯å¯¹è±¡ï¼Œè€Œæ˜¯å­—ç¬¦ä¸²äº†...</span><br><span class="hljs-built_in">console</span>.log(<span class="hljs-string">&#x27;str2&#x27;</span>, str2);<br></code></pre></td></tr></table></figure><figure class="highlight openscad"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><code class="hljs openscad"><span class="hljs-comment">// JSONå­—ç¬¦ä¸²è½¬æˆå¯¹è±¡</span><br><span class="hljs-comment">// JSON å­—ç¬¦ä¸²å¤–å±‚æ˜¯å•å¼•å·å“¦!!</span><br><span class="hljs-built_in">let</span> <span class="hljs-built_in">str</span> = &#x27;&#123;<span class="hljs-string">&quot;name&quot;</span>: <span class="hljs-string">&quot;å°æ˜&quot;</span>, <span class="hljs-string">&quot;sex&quot;</span>: <span class="hljs-string">&quot;ç”·&quot;</span>, <span class="hljs-string">&quot;age&quot;</span>:<span class="hljs-number">18</span>&#125;&#x27;<br><span class="hljs-built_in">let</span> obj = JSON.parse(<span class="hljs-built_in">str</span>);<br>console.<span class="hljs-built_in">log</span>(&#x27;obj.name&#x27;, obj.name);   <span class="hljs-comment">// å°æ˜</span><br></code></pre></td></tr></table></figure><hr><h4 id="æ‰‹å†™-ajax-æ ¸å¿ƒæ–¹æ³•"><a href="#æ‰‹å†™-ajax-æ ¸å¿ƒæ–¹æ³•" class="headerlink" title="æ‰‹å†™ ajax æ ¸å¿ƒæ–¹æ³•"></a>æ‰‹å†™ ajax æ ¸å¿ƒæ–¹æ³•</h4><p>å“ˆå“ˆ, ä»¥ä¸è´Ÿè´£ä»»çš„æ€åº¦æ¥è¯´ ğŸ¤ª</p><blockquote><p><code>å‰ç«¯</code> æ˜¯ç”¨æ¥æ˜¾ç¤ºæ•°æ®çš„<br><code>åç«¯</code> æ˜¯ç”¨æ¥æä¾›æ•°æ®çš„</p></blockquote><p>æ‰€ä»¥ï¼Œå‰ç«¯æœ‰ä¸€ä¸ªéå¸¸é‡è¦çš„å·¥ä½œæ˜¯å‘åç«¯ç´¢è¦<code>æ•°æ®</code>å¹¶å°†æ•°æ®è¿›è¡Œé¡µé¢æ˜¾ç¤º</p><p>å¦‚ä½•å‘åç«¯ç´¢è¦æ•°æ®å‘¢ï¼Ÿ</p><h5 id="ä¹¦å†™-ajxa-4-ä¸ªæ ¸å¿ƒæ­¥éª¤"><a href="#ä¹¦å†™-ajxa-4-ä¸ªæ ¸å¿ƒæ­¥éª¤" class="headerlink" title="ä¹¦å†™ ajxa 4 ä¸ªæ ¸å¿ƒæ­¥éª¤"></a>ä¹¦å†™ ajxa 4 ä¸ªæ ¸å¿ƒæ­¥éª¤</h5><blockquote><p>4 ä¸ªæ­¥éª¤ï¼ä½†è¦æ³¨æ„æ‰§è¡Œé¡ºåºå“¦ï¼</p></blockquote><ol><li>åˆ›å»ºä¸€ä¸ªè¯·æ±‚å¯¹è±¡, js æä¾›çš„æ„é€ å‡½æ•° XMLHttpRequest(åˆ†å¼€è®°å¿†ï¼šXML Http Request)</li></ol><figure class="highlight reasonml"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs reasonml"><span class="hljs-keyword">let</span> xhr = <span class="hljs-keyword">new</span> <span class="hljs-constructor">XMLHttpRequest()</span><br></code></pre></td></tr></table></figure><ol start="2"><li><p>è®¾ç½®è¯·æ±‚çš„æ•°æ®å¾—åˆ°è¿”å›æ—¶çš„å¤„ç†å‡½æ•°</p><blockquote><p>xhr.onloadend(åˆ†å¼€è®°å¿†ï¼šon load end) â€“&gt; æ‰§è¡Œæ–¹å¼æœ‰ç‚¹ç±»ä¼¼ onclick è¿™ç±»å‡½æ•°</p></blockquote></li></ol><figure class="highlight awk"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><code class="hljs awk">xhr.onloadend = <span class="hljs-keyword">function</span>() &#123;<br>  <span class="hljs-regexp">//</span> è¯¥æ•°æ®å…¨æ˜¯æœåŠ¡å™¨è¿”å›çš„jsonå­—ç¬¦ä¸²<br>  <span class="hljs-regexp">//</span> è¯·æ±‚çš„æ•°æ®æ”¾åœ¨å“ªäº†ï¼Ÿè¯·æ±‚çš„æ•°æ®å…¶å®æ”¾åœ¨äº†è¯·æ±‚å¯¹è±¡ä¸Šé¢<br>  xhr.responseText<br>  <span class="hljs-regexp">//</span> è¿›è¡Œè½¬åŒ–<br>  let stus = JSON.parse(xhr.responseText)<br>&#125;<br></code></pre></td></tr></table></figure><ol start="3"><li>è®¾ç½®è¯·æ±‚ä¿¡æ¯</li></ol><figure class="highlight awk"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><code class="hljs awk">å‘è°è¯·æ±‚ï¼š<br>ä¾‹å¦‚ http:<span class="hljs-regexp">//</span>www.jd.comã€http:<span class="hljs-regexp">//</span>www.baidu.com<br>xhr.open(<span class="hljs-string">&#x27;GET&#x27;</span>, <span class="hljs-string">&#x27;https://jsonplaceholder.typicode.com/todos&#x27;</span>)<br></code></pre></td></tr></table></figure><ol start="4"><li>å‘é€è¯·æ±‚</li></ol><figure class="highlight autoit"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs autoit">xhr.<span class="hljs-built_in">send</span>()<br></code></pre></td></tr></table></figure><figure class="highlight reasonml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><code class="hljs reasonml"><span class="hljs-comment">// æ•´ä½“æ“ä½œå¦‚ä¸‹ï¼š</span><br><br><span class="hljs-keyword">let</span> xhr = <span class="hljs-keyword">new</span> <span class="hljs-constructor">XMLHttpRequest()</span>;<br>xhr.oploadend = <span class="hljs-keyword">function</span><span class="hljs-literal">()</span> &#123;<br>  <span class="hljs-keyword">let</span> stus = <span class="hljs-module-access"><span class="hljs-module"><span class="hljs-identifier">JSON</span>.</span></span>parse(xhr.responseTest)<br>  show<span class="hljs-constructor">Table(<span class="hljs-params">stus</span>)</span><br>&#125;<br>xhr.<span class="hljs-keyword">open</span>(&#x27;get&#x27;, &#x27;https:<span class="hljs-comment">//jsonplaceholder.typicode.com/todos&#x27;);</span><br>xhr.send<span class="hljs-literal">()</span>;<br></code></pre></td></tr></table></figure><head>  ..  <script src="//cdn.jsdelivr.net/npm/@waline/client"></script>  ...</head><body>  ...  <div id="waline"></div>  <script>    Waline({      el: '#waline',       avatar: 'monsterid',      serverURL: 'https://blog-api-9sizcti78-bruce-shuai.vercel.app/',    });  </script></body>]]></content>
    
    
    <categories>
      
      <category>JavaScript</category>
      
    </categories>
    
    
    <tags>
      
      <tag>å‰ç«¯</tag>
      
    </tags>
    
  </entry>
  
  
  
  <entry>
    <title>ä¸€ç¯‡æ–‡ç« è§£å†³Promise...thenï¼Œasync/awaitæ‰§è¡Œé¡ºåºç±»å‹é¢˜</title>
    <link href="/2021/10/08/%E4%B8%80%E7%AF%87%E6%96%87%E7%AB%A0%E8%A7%A3%E5%86%B3Promise-then%EF%BC%8Casync-await%E6%89%A7%E8%A1%8C%E9%A1%BA%E5%BA%8F%E7%B1%BB%E5%9E%8B%E9%A2%98/"/>
    <url>/2021/10/08/%E4%B8%80%E7%AF%87%E6%96%87%E7%AB%A0%E8%A7%A3%E5%86%B3Promise-then%EF%BC%8Casync-await%E6%89%A7%E8%A1%8C%E9%A1%BA%E5%BA%8F%E7%B1%BB%E5%9E%8B%E9%A2%98/</url>
    
    <content type="html"><![CDATA[<p>æœ€è¿‘æˆ‘åœ¨æ²¸ç‚¹é‡Œæ‘¸é±¼çš„æ—¶å€™ï¼Œå‘ç°äº†ä¸€äº›æ˜å‹åœ¨ä¸çº¦è€ŒåŒçš„è®¨è®ºä¸€ç§ç±»å‹çš„é¢˜ï¼Œå³ Promiseâ€¦then, async/await æ‰§è¡Œé¡ºåºç±»å‹çš„é¢˜ã€‚</p><p><img src="https://p9-juejin.byteimg.com/tos-cn-i-k3u1fbpfcp/61f40af93cec47d281efaa67db337670~tplv-k3u1fbpfcp-watermark.image" alt="æˆªå±2021-06-10 ä¸‹åˆ10.18.25.png"></p><p><img src="https://p6-juejin.byteimg.com/tos-cn-i-k3u1fbpfcp/fdb16e753c6742ae94f531022a41d789~tplv-k3u1fbpfcp-watermark.image" alt="æˆªå±2021-06-10 ä¸‹åˆ10.16.31.png"><br>æ°å¥½ï¼Œåœ¨å‰ä¸€æ®µæ—¶é—´æˆ‘å¯¹æ­¤ç§ç±»å‹çš„é¢˜æœ‰æ‰€ç ”ç©¶ ğŸ“ƒã€‚å› æ­¤ï¼Œæˆ‘ä¹Ÿæƒ³è¶è¿™ä¸ªæœºä¼šçœ‹çœ‹æ˜¯å¦èƒ½æŠŠè¿™ç§ç±»å‹çš„é¢˜è®²è¿°æ¸…æ¥šã€‚</p><p>åºŸè¯å°±ä¸å¤šè¯´äº†ï¼Œå…ˆå‡ºå‡ é“é¢˜ï¼Œå¤§ä¼™è¯•è¯•çœ‹ï¼Œèƒ½ä¸èƒ½æŠŠè¿™å‡ é“é¢˜åšå‡ºæ¥ï¼<br>ï¼ˆæ³¨ï¼šä»¥ä¸‹é¢˜ç›®éƒ½æ˜¯ä»ç½‘ä¸Šä»¥åŠæ˜å‹å‘çš„æ²¸ç‚¹é‡Œè·å–çš„ï¼‰</p><figure class="highlight coffeescript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><code class="hljs coffeescript">é¢˜ç›®ä¸€ï¼š<br><span class="hljs-built_in">console</span>.log(<span class="hljs-number">100</span>);<br><span class="hljs-built_in">setTimeout</span>(<span class="hljs-function"><span class="hljs-params">()</span> =&gt;</span> &#123;<br>  <span class="hljs-built_in">console</span>.log(<span class="hljs-number">200</span>);<br>&#125;)<br><span class="hljs-built_in">Promise</span>.resolve().<span class="hljs-keyword">then</span>(<span class="hljs-function"><span class="hljs-params">()</span> =&gt;</span> &#123;<br>  <span class="hljs-built_in">console</span>.log(<span class="hljs-number">300</span>);<br>&#125;)<br><span class="hljs-built_in">console</span>.log(<span class="hljs-number">400</span>);<br>æ±‚æ‰“å°ç»“æœï¼š<br></code></pre></td></tr></table></figure><figure class="highlight coffeescript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><code class="hljs coffeescript">é¢˜ç›®äºŒï¼š<br><span class="hljs-built_in">Promise</span>.resolve().<span class="hljs-keyword">then</span>(<span class="hljs-function"><span class="hljs-params">()</span> =&gt;</span> &#123;<br>  <span class="hljs-built_in">console</span>.log(<span class="hljs-number">1</span>);<br>  <span class="hljs-keyword">throw</span> <span class="hljs-keyword">new</span> <span class="hljs-built_in">Error</span>(<span class="hljs-string">&#x27;error1&#x27;</span>)<br>&#125;).<span class="hljs-keyword">catch</span>(<span class="hljs-function"><span class="hljs-params">()</span> =&gt;</span> &#123;<br>  <span class="hljs-built_in">console</span>.log(<span class="hljs-number">2</span>);<br>&#125;).<span class="hljs-keyword">then</span>(<span class="hljs-function"><span class="hljs-params">()</span> =&gt;</span> &#123;<br>  <span class="hljs-built_in">console</span>.log(<span class="hljs-number">3</span>);<br>&#125;)<br>æ±‚æ‰“å°ç»“æœï¼š<br></code></pre></td></tr></table></figure><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br></pre></td><td class="code"><pre><code class="hljs javascript">é¢˜ç›®ä¸‰ï¼š<br><span class="hljs-keyword">async</span> <span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">async1</span> (<span class="hljs-params"></span>) </span>&#123;<br>  <span class="hljs-built_in">console</span>.log(<span class="hljs-string">&#x27;async1 start&#x27;</span>);<br>  <span class="hljs-keyword">await</span> async2();<br>  <span class="hljs-built_in">console</span>.log(<span class="hljs-string">&#x27;async1 end&#x27;</span>);<br>&#125;<br><span class="hljs-keyword">async</span> <span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">async2</span> (<span class="hljs-params"></span>) </span>&#123;<br>  <span class="hljs-built_in">console</span>.log(<span class="hljs-string">&#x27;async2&#x27;</span>);<br>&#125;<br><span class="hljs-built_in">console</span>.log(<span class="hljs-string">&#x27;script start&#x27;</span>);<br><span class="hljs-built_in">setTimeout</span>(<span class="hljs-function"><span class="hljs-keyword">function</span> (<span class="hljs-params"></span>) </span>&#123;<br>  <span class="hljs-built_in">console</span>.log(<span class="hljs-string">&#x27;setTimeout&#x27;</span>);<br>&#125;, <span class="hljs-number">0</span>)<br>async1()<br><span class="hljs-keyword">new</span> <span class="hljs-built_in">Promise</span> (<span class="hljs-function"><span class="hljs-keyword">function</span> (<span class="hljs-params">resolve</span>) </span>&#123;<br>  <span class="hljs-built_in">console</span>.log(<span class="hljs-string">&#x27;promise1&#x27;</span>)<br>  resolve()<br>&#125;).then(<span class="hljs-function"><span class="hljs-keyword">function</span> (<span class="hljs-params"></span>) </span>&#123;<br>  <span class="hljs-built_in">console</span>.log(<span class="hljs-string">&#x27;promise2&#x27;</span>)<br>&#125;)<br><br><span class="hljs-built_in">console</span>.log(<span class="hljs-string">&#x27;script end&#x27;</span>)<br>æ±‚æ‰“å°ç»“æœï¼š<br></code></pre></td></tr></table></figure><figure class="highlight coffeescript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br></pre></td><td class="code"><pre><code class="hljs coffeescript">é¢˜ç›®å››ï¼š<br><span class="hljs-built_in">setTimeout</span>(<span class="hljs-function"><span class="hljs-params">()</span> =&gt;</span> &#123;<br>  <span class="hljs-built_in">console</span>.log(<span class="hljs-string">&#x27;0&#x27;</span>);<br>&#125;, <span class="hljs-number">0</span>)<br><span class="hljs-keyword">new</span> <span class="hljs-built_in">Promise</span>(<span class="hljs-function"><span class="hljs-params">(resolve, reject)</span> =&gt;</span> &#123;<br>  <span class="hljs-built_in">console</span>.log(<span class="hljs-string">&#x27;1&#x27;</span>);<br>  resolve();<br>&#125;).<span class="hljs-keyword">then</span>(<span class="hljs-function"><span class="hljs-params">()</span> =&gt;</span> &#123;<br>  <span class="hljs-built_in">console</span>.log(<span class="hljs-string">&#x27;2&#x27;</span>);<br>  <span class="hljs-keyword">new</span> <span class="hljs-built_in">Promise</span>(<span class="hljs-function"><span class="hljs-params">(resolve, reject)</span> =&gt;</span> &#123;<br>    <span class="hljs-built_in">console</span>.log(<span class="hljs-string">&#x27;3&#x27;</span>);<br>    resolve();<br>  &#125;).<span class="hljs-keyword">then</span>(<span class="hljs-function"><span class="hljs-params">()</span> =&gt;</span> &#123;<br>    <span class="hljs-built_in">console</span>.log(<span class="hljs-string">&#x27;4&#x27;</span>);<br>  &#125;).<span class="hljs-keyword">then</span>(<span class="hljs-function"><span class="hljs-params">()</span> =&gt;</span> &#123;<br>    <span class="hljs-built_in">console</span>.log(<span class="hljs-string">&#x27;5&#x27;</span>);<br>  &#125;)<br>&#125;).<span class="hljs-keyword">then</span>(<span class="hljs-function"><span class="hljs-params">()</span> =&gt;</span> &#123;<br>  <span class="hljs-built_in">console</span>.log(<span class="hljs-string">&#x27;6&#x27;</span>);<br>&#125;)<br><br><span class="hljs-keyword">new</span> <span class="hljs-built_in">Promise</span>(<span class="hljs-function"><span class="hljs-params">(resolve, reject)</span> =&gt;</span> &#123;<br>  <span class="hljs-built_in">console</span>.log(<span class="hljs-string">&#x27;7&#x27;</span>);<br>  resolve()<br>&#125;).<span class="hljs-keyword">then</span>(<span class="hljs-function"><span class="hljs-params">()</span> =&gt;</span> &#123;<br>  <span class="hljs-built_in">console</span>.log(<span class="hljs-string">&#x27;8&#x27;</span>);<br>&#125;)<br>æ±‚æ‰“å°ç»“æœï¼š<br></code></pre></td></tr></table></figure><p>ä¸çŸ¥é“å¤§å®¶å¯¹äºä¸Šé¢å››é“é¢˜æ˜¯å¦æ„Ÿè§‰æœ‰ç‚¹æ¶å¿ƒï¼Ÿå“ˆå“ˆï¼Œå¦‚æœæ„Ÿåˆ°æ¶å¿ƒï¼Œå°±å¯¹äº†ï¼è·Ÿç€è¿™ç¯‡æ–‡ç« èµ°ï¼Œç›¸ä¿¡å¤§å®¶åœ¨æ–‡ç« çœ‹å®Œä¹‹åèƒ½è½»æ¾è§£å†³ä¸Šé¢çš„å‡ é“é¢˜ï¼</p><p>åºŸè¯ä¸å¤šè¯´ï¼Œå¦‚æœæœ‰å…´è¶£å°±æ¥ç€å¾€ä¸‹çœ‹å§ï¼</p><hr><p>é¦–å…ˆæˆ‘ä»¬éœ€è¦çŸ¥é“è¿™ç±»é¢˜å‹å®è´¨æ˜¯åœ¨è€ƒå¯Ÿä»¥ä¸‹å‡ ä¸ªå†…å®¹</p><ul><li>å¼‚æ­¥</li><li>event loop æ‰§è¡Œæœºåˆ¶</li><li>Promise è¯­æ³•</li><li>async/await è¯­æ³•</li><li>å®ä»»åŠ¡ã€å¾®ä»»åŠ¡</li></ul><p>å…¶å®ï¼ŒæŒæ¡äº†ä¸Šè¿°çš„äº”ä¸ªå†…å®¹ï¼Œæ— è®ºè¿™ç±»é¢˜å‹æ€ä¹ˆå˜ï¼Œä½ éƒ½èƒ½å°†é¢˜ç©äºè‚¡æŒä¹‹é—´(ä»–å¼ºä»»ä»–å¼ºï¼Œæ¸…é£æ‹‚å±±å²—)ã€‚</p><h3 id="å¼‚æ­¥"><a href="#å¼‚æ­¥" class="headerlink" title="å¼‚æ­¥"></a>å¼‚æ­¥</h3><p>ç”±äºèƒ½å¼€å§‹æ€è€ƒè¿™é“é¢˜çš„å…„å¼Ÿï¼Œæƒ³å¿…è¿˜æ˜¯æœ‰ä¸€å®šçš„ JS åŸºç¡€ã€‚æ‰€ä»¥æˆ‘ä¹Ÿä¸å†ç»†è®²å•¥æ˜¯å¼‚æ­¥ã€ä»¥åŠ event loop æ‰§è¡Œæœºåˆ¶äº†(è¿™ç±»åšæ–‡ç½‘ä¸Šä¸€æŠ“ä¸€å¤§æŠŠ~)ã€‚æˆ‘åªç®€å•åˆ†äº«ä¸€ä¸‹æˆ‘å¯¹äºå¼‚æ­¥çš„ä¸€äº›æ„Ÿæ‚Ÿï¼š</p><figure class="highlight coffeescript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><code class="hljs coffeescript"><span class="hljs-number">1</span>ã€å¼‚æ­¥æ˜¯ç”¨æ¥è§£å†³JSå•çº¿ç¨‹ç­‰å¾…è¿™ç§é—®é¢˜çš„<br><span class="hljs-number">2</span>ã€å¼‚æ­¥æ˜¯åŸºäºå›è°ƒå‡½æ•°çš„å½¢å¼æ¥å®ç°çš„<br><span class="hljs-number">3</span>ã€å¸¸è§çš„å¼‚æ­¥æœ‰ï¼š<span class="hljs-built_in">setTimeout</span>ã€ajaxã€<span class="hljs-built_in">Promise</span>â€¦â€¦<span class="hljs-keyword">then</span>ã€<span class="hljs-keyword">async</span>/<span class="hljs-keyword">await</span>ã€å›¾ç‰‡åŠ è½½ã€ç½‘ç»œè¯·æ±‚èµ„æº<br><span class="hljs-number">4</span>ã€ç‰¢è®°<span class="hljs-number">5</span>ä¸ªç‰ˆå—  Call Stackã€ Web APIsã€ Browser <span class="hljs-built_in">console</span>ã€ Callback Queue<br>ã€ micro task queue è¿™äº”ä¸ªç‰ˆå—é€éœ²å‡ºå¼‚æ­¥çš„æ‰§è¡Œè¿‡ç¨‹<br><span class="hljs-number">5</span>ã€å®ä»»åŠ¡æ˜¯åœ¨DOMæ¸²æŸ“åè§¦å‘ï¼Œå¾®ä»»åŠ¡æ˜¯åœ¨DOMæ¸²æŸ“å‰è§¦å‘<br></code></pre></td></tr></table></figure><h3 id="Promiseã€-Async-await"><a href="#Promiseã€-Async-await" class="headerlink" title="Promiseã€ Async/await"></a>Promiseã€ Async/await</h3><p>å¾ˆå¤šè®²<code>Promise</code>çš„æ–‡ç« éƒ½è¯´è¿‡ï¼Œ<code>Promise</code>çš„å‡ºç°æ˜¯ä¸ºäº†è§£å†³è‡­åæ˜­è‘—çš„<code>callback hell</code>ã€‚ç”±äºå¼‚æ­¥æ˜¯åŸºäºå›è°ƒå‡½æ•°çš„å½¢å¼æ¥å®ç°çš„ï¼Œé‚£ä¹ˆå¼‚æ­¥å°±ç¦»ä¸å¼€å›è°ƒå‡½æ•°ã€‚ä½†åœ¨ä¸Šå¤æ—¶æœŸï¼Œåäººç±»çš„åµŒå¥—å›è°ƒè®©è€ä¸€è¾ˆçš„ç¨‹åºå‘˜ä»¬è‹¦ä¸å ªè¨€â€¦è€Œ Promise æ­é… then å±•ç°çš„ç®¡é“å¼å›è°ƒå‡½æ•°ï¼Œè®©å¼‚æ­¥æ›´ç›´è§‚ã€æ›´ä¼˜é›…çš„å±•ç°å‡ºæ¥ï¼Œå¹¿å—å¤§å®¶å¥½è¯„ï¼</p><p>è€Œ<code>async/await</code> æ˜¯ ECMAScript 2017 æå‡ºçš„å†…å®¹ã€‚ä½†äº‹å®ä¸Šå®ƒä»¬åªæ˜¯<code>Promise</code>çš„è¯­æ³•ç³–ï¼Œä½†è¿™é¢— ğŸ¬ è´¼ç”œï¼</p><p>é’ˆå¯¹<code>Promise</code>ä»¥åŠ<code>async/await</code>çš„éªšç”¨æ³•ï¼Œæˆ‘æƒ³å°è¯•ç”¨åƒå±‚é¥¼çš„å¥—è·¯æ¥è®²è®²~</p><h5 id="ç¬¬ä¸€å±‚ï¼š"><a href="#ç¬¬ä¸€å±‚ï¼š" class="headerlink" title="ç¬¬ä¸€å±‚ï¼š"></a>ç¬¬ä¸€å±‚ï¼š</h5><p>Promise æ˜¯ä¸€ä¸ªç±»ï¼ˆå‡½æ•°ï¼‰ï¼Œæ¥å—ä¸€ä¸ªå›è°ƒå‡½æ•°ä½œä¸ºå‚æ•°ï¼Œå¹¶ä¸”è¿™ä¸ªå›è°ƒå‡½æ•°çš„å‚æ•°ä¹Ÿæœ‰ä¸¤ä¸ªï¼Œè¿™ä¸¤ä¸ªå‚æ•°çº¦å®šä¿—æˆè¢«å‘½åä¸º <code>resolve</code>, <code>reject</code></p><figure class="highlight coffeescript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><code class="hljs coffeescript"><span class="hljs-built_in">Promise</span>(<span class="hljs-function"><span class="hljs-params">(resolve, reject)</span> =&gt;</span> &#123;<br>    ...<br>&#125;)<br></code></pre></td></tr></table></figure><h5 id="ç¬¬äºŒå±‚ï¼š"><a href="#ç¬¬äºŒå±‚ï¼š" class="headerlink" title="ç¬¬äºŒå±‚ï¼š"></a>ç¬¬äºŒå±‚ï¼š</h5><p><code>resolve</code>, <code>reject</code>è¿™ä¸¤ä¸ªå‚æ•°å…¶å®ä¹Ÿéƒ½æ˜¯å‡½æ•°</p><figure class="highlight gcode"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><code class="hljs gcode">Promise<span class="hljs-comment">((resolve, reject)</span> =&gt; &#123;<br>    <span class="hljs-keyword">if</span> <span class="hljs-comment">(...)</span> &#123;<br>        resolve<span class="hljs-comment">(...)</span>;     <span class="hljs-comment">// æ‰§è¡Œresolveå‡½æ•°</span><br>    &#125; else &#123;<br>        reject<span class="hljs-comment">(...)</span>;      <span class="hljs-comment">// æ‰§è¡Œrejectå‡½æ•°</span><br>    &#125;<br>&#125;)<br></code></pre></td></tr></table></figure><h5 id="ç¬¬ä¸‰å±‚ï¼š"><a href="#ç¬¬ä¸‰å±‚ï¼š" class="headerlink" title="ç¬¬ä¸‰å±‚ï¼š"></a>ç¬¬ä¸‰å±‚ï¼š</h5><p>å¯¹äºç´§è·Ÿ Promise å®ä¾‹çš„<code>then</code>ï¼Œå…¶å‚æ•°ç­‰äº<code>resolve</code>æ¥å—çš„å‚æ•°ï¼›ç´§è·Ÿ Promise å®ä¾‹çš„<code>catch</code>ï¼Œå…¶å‚æ•°ç­‰äº<code>reject</code>æ¥å—çš„å‚æ•°ã€‚</p><figure class="highlight coffeescript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br></pre></td><td class="code"><pre><code class="hljs coffeescript">const p1 = <span class="hljs-keyword">new</span> <span class="hljs-built_in">Promise</span>(<span class="hljs-function"><span class="hljs-params">(resolve)</span> =&gt;</span> &#123;    <span class="hljs-regexp">//</span> pä¸º<span class="hljs-built_in">Promise</span>å®ä¾‹<br>    const a = <span class="hljs-number">100</span>;<br>    resolve(a);<br>&#125;)<br><br>p1.<span class="hljs-keyword">then</span>(<span class="hljs-function"><span class="hljs-params">(param)</span> =&gt;</span> &#123;<br>    <span class="hljs-built_in">console</span>.log(<span class="hljs-string">&#x27;param:&#x27;</span>, param);      <span class="hljs-regexp">//</span> param: <span class="hljs-number">100</span><br>&#125;)<br><br>const p2 = <span class="hljs-keyword">new</span> <span class="hljs-built_in">Promise</span>(<span class="hljs-function"><span class="hljs-params">(resolve, reject)</span> =&gt;</span> &#123;<br>    const a = <span class="hljs-number">100</span>;<br>    reject(a);<br>&#125;)<br><br>p2.<span class="hljs-keyword">catch</span>(<span class="hljs-function"><span class="hljs-params">(param)</span> =&gt;</span> &#123;<br>    <span class="hljs-built_in">console</span>.log(<span class="hljs-string">&#x27;param&#x27;</span>, param);<br>&#125;)<br><br></code></pre></td></tr></table></figure><h5 id="ç¬¬å››å±‚ï¼š"><a href="#ç¬¬å››å±‚ï¼š" class="headerlink" title="ç¬¬å››å±‚ï¼š"></a>ç¬¬å››å±‚ï¼š</h5><p>Promise çš„å®ä¾‹æœ‰ä¸‰ç§çŠ¶æ€ï¼š <code>pending(åŠ è½½ä¸­)</code>ã€<code>fulfilled(æ‰§è¡ŒæˆåŠŸ)</code>ã€<code>rejected(æ‰§è¡Œé”™è¯¯)</code>ã€‚å…¶å®æˆ‘ä»¬å¾ˆå¥½ç†è§£è¿™ä¸‰ç§çŠ¶æ€ï¼Œå› ä¸ºå®ƒä»¬æ°å¥½å¯¹åº”äº†<code>å¼‚æ­¥æ­£åœ¨æ‰§è¡Œ</code>å’Œ<code>å¼‚æ­¥æ‰§è¡Œå®Œçš„ç»“æœ</code>(æ— éæˆåŠŸæˆ–å¤±è´¥ä¸¤ç§çŠ¶æ€)è¿™ä¸‰ç§çŠ¶æ€</p><p>ä¸‰ç§çŠ¶æ€çš„è¡¨ç°ï¼š</p><ul><li>pending: Promise å®ä¾‹å¤„äº<code>pending</code>çŠ¶æ€æ—¶ï¼Œä¸ä¼šè§¦å‘ then å’Œ catchã€‚</li><li>fufilled: Promise å®ä¾‹å¤„äº<code>fulfilled</code>çŠ¶æ€æ—¶ï¼Œåªä¼šè§¦å‘ then(ä¸ä¼šè§¦å‘ catch)</li><li>rejectedï¼š Promise å®ä¾‹å¤„äº<code>rejected</code>çŠ¶æ€æ—¶ï¼Œåªä¼šè§¦å‘ catch(ä¸ä¼šè§¦å‘ then)</li></ul><p>(æ— è®ºæ˜¯ then è¿˜æ˜¯ catchï¼Œå®ƒä»¬é‡Œé¢éƒ½æ˜¯å›è°ƒå‡½æ•°)</p><p>é‚£ä¹ˆé—®é¢˜æ¥äº†ï¼Œå¦‚ä½•åˆ¤æ–­ Promise å®ä¾‹å¯¹è±¡æ˜¯å¤„äºé‚£ç§çŠ¶æ€å‘¢ï¼Ÿ</p><p>å¾ˆç®€å•ï¼Œçœ‹ä¸‹é¢ä»£ç ï¼š</p><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><code class="hljs javascript"><span class="hljs-keyword">const</span> p = <span class="hljs-keyword">new</span> <span class="hljs-built_in">Promise</span>(<span class="hljs-function">(<span class="hljs-params">resolve, reject</span>) =&gt;</span> &#123;<br>  <span class="hljs-comment">// å•¥ä¹Ÿæ²¡æœ‰åš~</span><br>&#125;)<br><br><span class="hljs-built_in">console</span>.log(<span class="hljs-string">&#x27;p&#x27;</span>, p);<br></code></pre></td></tr></table></figure><p>Chrome æ§åˆ¶å°æ˜¾ç¤ºç»“æœå¦‚ä¸‹å›¾ï¼š</p><p><img src="https://p6-juejin.byteimg.com/tos-cn-i-k3u1fbpfcp/a40d9c5af8794683b9660bd378bd0316~tplv-k3u1fbpfcp-watermark.image" alt="æˆªå±2021-06-12 ä¸‹åˆ9.00.33.png"></p><p>æˆªå›¾è¯´æ˜äº†æ­¤æ—¶çš„ Promise å®ä¾‹æ˜¯å¤„äº<code>pending</code>çŠ¶æ€çš„ã€‚å…¶å®ï¼Œå½“ Promise å†…éƒ¨çš„å›è°ƒä¸æ‰§è¡Œ<code>resolve</code>æˆ–<code>reject</code>çš„æ—¶å€™ï¼ŒPromise å®ä¾‹å°±å¤„äº<code>pending</code>çŠ¶æ€ï¼</p><p>å†çœ‹ä¸‹é¢çš„ä»£ç  ğŸ‘‡ğŸ»</p><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><code class="hljs javascript"> <span class="hljs-keyword">const</span> p1 = <span class="hljs-keyword">new</span> <span class="hljs-built_in">Promise</span>(<span class="hljs-function">(<span class="hljs-params">resolve</span>) =&gt;</span> &#123;    <span class="hljs-comment">// p1ä¸ºPromiseå®ä¾‹</span><br>     <span class="hljs-keyword">const</span> a = <span class="hljs-number">100</span>;<br>     resolve(a);<br> &#125;)<br><br><span class="hljs-built_in">console</span>.log(<span class="hljs-string">&#x27;p1&#x27;</span>, p1)    <span class="hljs-comment">// fulfilled</span><br><br> <span class="hljs-keyword">const</span> p2 = <span class="hljs-keyword">new</span> <span class="hljs-built_in">Promise</span>(<span class="hljs-function">(<span class="hljs-params">resolve, reject</span>) =&gt;</span> &#123;<br>     <span class="hljs-keyword">const</span> a = <span class="hljs-number">100</span>;<br>     reject(a);<br> &#125;)<br><br><span class="hljs-built_in">console</span>.log(<span class="hljs-string">&#x27;p2&#x27;</span>, p2)    <span class="hljs-comment">// rejected</span><br></code></pre></td></tr></table></figure><p>Chrome æ§åˆ¶å°æ˜¾ç¤ºç»“æœå¦‚ä¸‹å›¾ï¼š<br><img src="https://p9-juejin.byteimg.com/tos-cn-i-k3u1fbpfcp/508e710a9a0847d69cc13e1f79e03ef7~tplv-k3u1fbpfcp-watermark.image" alt="æˆªå±2021-06-12 ä¸‹åˆ9.03.58.png"></p><p>è¿™é‡Œçš„ä»£ç æ˜¯å€Ÿç”¨çš„ç¬¬ä¸‰å±‚çš„ä»£ç ï¼Œå…¶å®çœ‹åˆ°è¿™å„¿å°±è§£é‡Šäº†ç¬¬ä¸‰å±‚çš„å¥—è·¯ã€‚å¯¹äºç¬¬ä¸€ä¸ª Promise å®ä¾‹æ‰§è¡Œå‚æ•°<code>resolve</code>å°±ä»£è¡¨äº†ï¼Œå½“å‰ Promise å®ä¾‹å¯¹è±¡çš„çŠ¶æ€ä¸º<code>fulfilled</code>ï¼Œå› æ­¤æ¥ä¸‹æ¥å¯ä»¥è§¦å‘ thenï¼Œä»¥åŠå¯¹åº”çš„å›è°ƒã€‚å¦‚æœ Promise å®ä¾‹å¯¹è±¡æ‰§è¡Œäº†<code>reject</code>ï¼Œåˆ™å®ä¾‹å¯¹è±¡çš„çŠ¶æ€å˜ä¸ºäº† <code>rejected</code>ï¼Œå¯ä»¥è§¦å‘ catch~ æœ‰å…´è¶£çš„å°ä¼™ä¼´å¯ä»¥è¯•è¯•ï¼Œåœ¨<code>fulfilled</code>çŠ¶æ€æ‰§è¡Œä¸‹ catch æˆ–è€…åœ¨<code>rejected</code>çŠ¶æ€ä¸‹æ‰§è¡Œä¸‹ thenï¼Œè¯•è¯•èƒ½å¦æ‰§è¡Œä»£ç æˆåŠŸã€‚</p><h5 id="ç¬¬äº”å±‚ï¼š"><a href="#ç¬¬äº”å±‚ï¼š" class="headerlink" title="ç¬¬äº”å±‚ï¼š"></a>ç¬¬äº”å±‚ï¼š</h5><p>åœ¨ç¬¬äº”å±‚æœ‰ 3 å¥è‡³ç†åè¨€éœ€è¦çŸ¥é“(ä¸éœ€è¦å»æ­»è®°ç¡¬èƒŒï¼Œä¸‹é¢æˆ‘ä¼šç”¨ä¾‹å­å¸®åŠ©ä½ ç†è§£)</p><blockquote><p>æ— è®ºæ˜¯ then è¿˜æ˜¯ catch é‡Œçš„å›è°ƒå†…å®¹åªè¦ä»£ç æ­£å¸¸æ‰§è¡Œæˆ–è€…æ­£å¸¸è¿”å›ï¼Œåˆ™å½“å‰æ–°çš„ Promise å®ä¾‹ä¸º fulfilled çŠ¶æ€ã€‚å¦‚æœæœ‰æŠ¥é”™æˆ–è¿”å› Promise.reject()åˆ™æ–°çš„ Promise å®ä¾‹ä¸º rejected çŠ¶æ€ã€‚</p></blockquote><blockquote><p>fulfilled çŠ¶æ€èƒ½å¤Ÿè§¦å‘ then å›è°ƒ</p></blockquote><blockquote><p>rejected çŠ¶æ€èƒ½å¤Ÿè§¦å‘ catch å›è°ƒ</p></blockquote><p>ä¸¾ä¾‹ä¹‹å‰æˆ‘å…ˆè¡¥å……ä¸€ä¸ªå°çŸ¥è¯†ï¼</p><figure class="highlight coffeescript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><code class="hljs coffeescript"><span class="hljs-built_in">Promise</span>.resolve()  è¡¨ç¤ºä¸€ä¸ªfulfilledçŠ¶æ€çš„<span class="hljs-built_in">Promise</span>å®ä¾‹<br><span class="hljs-built_in">Promise</span>.reject()   è¡¨ç¤ºä¸€ä¸ªrejectedçŠ¶æ€çš„<span class="hljs-built_in">Promise</span>å®ä¾‹<br></code></pre></td></tr></table></figure><p>å¥½ï¼Œæˆ‘å°†æ”¾ç è¿‡æ¥ï¼</p><figure class="highlight coffeescript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><code class="hljs coffeescript">é¢˜ç›®ä¸€ï¼š<br><span class="hljs-built_in">Promise</span>.resolve().<span class="hljs-keyword">then</span>(<span class="hljs-function"><span class="hljs-params">()</span> =&gt;</span> &#123;<br>    <span class="hljs-built_in">console</span>.log(<span class="hljs-number">1</span>);<br>&#125;).<span class="hljs-keyword">catch</span>(<span class="hljs-function"><span class="hljs-params">()</span> =&gt;</span> &#123;<br>    <span class="hljs-built_in">console</span>.log(<span class="hljs-number">2</span>);<br>&#125;).<span class="hljs-keyword">then</span>(<span class="hljs-function"><span class="hljs-params">()</span> =&gt;</span> &#123;<br>    <span class="hljs-built_in">console</span>.log(<span class="hljs-number">3</span>);<br>&#125;)<br></code></pre></td></tr></table></figure><p>åˆçœ‹æ­¤é¢˜ï¼Œæ„Ÿè§‰ä¼¼ä¹æ­¤é¢˜æœ‰ç‚¹éš¾åº¦~ ä¸è¿‡ï¼Œç»“åˆæˆ‘çš„ä¸‰å¥è‡³ç†åè¨€ï¼Œæˆ‘ä»¬ä¸€èµ·æ¥åˆ†æä¸€ä¸‹æ­¤é¢˜ï¼ï¼</p><p><code>Promise.resolve()</code> æ˜¯ä¸€ä¸ªçŠ¶æ€ä¸º<code>fulfilled</code>çŠ¶æ€çš„ Promise å®ä¾‹ã€‚<code>fulfilled</code>çŠ¶æ€èƒ½å¤Ÿè§¦å‘ then å›è°ƒã€‚å› æ­¤ï¼Œç¬¬ä¸€ä¸ª then ä¼šè¢«æ‰§è¡Œï¼Œå¹¶ä¸”èƒ½å¤Ÿé¡ºåˆ©æ‰“å°ç»“æœè€Œä¸æŠ¥é”™ï¼æ•… Promise.resolve().then(() =&gt; {console.log(1)}) è¿™ä¸ªæ–°çš„ Promise å®ä¾‹ä¸º<code>fulfilled</code>çŠ¶æ€ï¼Œæ‰€ä»¥å¯ä»¥è§¦å‘ä¸‹ä¸€ä¸ª thenï¼Œä½†æ˜¯æ— æ³•è§¦å‘ catchï¼Œæ•… catch çš„å†…å®¹å¿½ç•¥ï¼Œä»è€Œæ‰§è¡Œç¬¬äºŒä¸ª then çš„å†…å®¹ã€‚ æ‰€ä»¥ï¼Œæ­¤é¢˜çš„æ‰“å°ç»“æœä¸ºï¼š 1 3</p><p>å¥½äº†ï¼Œä¸‹é¢å†æ¥çœ‹çœ‹ç¬¬äºŒé¢˜(æ­¤é¢˜ä¹Ÿæ˜¯æ–‡ç« å¼€å¤´å‡ºçš„ç¬¬äºŒé¢˜)ï¼š</p><figure class="highlight coffeescript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><code class="hljs coffeescript"><span class="hljs-built_in">Promise</span>.resolve().<span class="hljs-keyword">then</span>(<span class="hljs-function"><span class="hljs-params">()</span> =&gt;</span> &#123;<br>    <span class="hljs-built_in">console</span>.log(<span class="hljs-number">1</span>);<br>    <span class="hljs-keyword">throw</span> <span class="hljs-keyword">new</span> <span class="hljs-built_in">Error</span>(<span class="hljs-string">&#x27;error1&#x27;</span>);<br>&#125;).<span class="hljs-keyword">catch</span>(<span class="hljs-function"><span class="hljs-params">()</span> =&gt;</span> &#123;<br>    <span class="hljs-built_in">console</span>.log(<span class="hljs-number">2</span>);<br>&#125;).<span class="hljs-keyword">then</span>(<span class="hljs-function"><span class="hljs-params">()</span> =&gt;</span> &#123;<br>    <span class="hljs-built_in">console</span>.log(<span class="hljs-number">3</span>)<br>&#125;)<br></code></pre></td></tr></table></figure><p>æœ‰äº†ä¸Šä¸€é¢˜çš„ç»éªŒï¼Œåšè¿™ä¸€é“é¢˜å°±è½»æ¾å¾ˆå¤šäº†~ Promise.resolve()æ˜¯ä¸€ä¸ª<code>fulfilled</code>çŠ¶æ€çš„å®ä¾‹ï¼Œæ‰€ä»¥å¯ä»¥è§¦å‘ thenï¼Œè€Œç¬¬ä¸€ä¸ª then ä¹‹ä¸­æœ‰ throw new Error(â€˜error1â€™) è¿™ç§æŠ¥é”™æ“ä½œï¼Œåˆ™ Promise.resolve.then(() =&gt; {<br>console.log(1);<br>throw new Error(â€˜error1â€™)<br>})å°±æ˜¯ä¸€ä¸ª<code>rejected</code>çŠ¶æ€çš„ Promise å®ä¾‹ï¼Œæ‰€ä»¥å¯ä»¥è§¦å‘ catchï¼Œcatch çš„å†…å®¹æ˜¯å¯ä»¥æ­£å¸¸æ‰§è¡Œçš„ï¼Œæ²¡æœ‰æŠ¥é”™è¯¯ï¼Œåˆ™ Promise.resolve().then(â€¦).catch(â€¦)æ˜¯ä¸€ä¸ª<code>fulfilled</code>çŠ¶æ€çš„ Promise å®ä¾‹ï¼Œå¯ä»¥è§¦å‘ thenï¼Œæ•… then çš„å†…å®¹èƒ½å¤Ÿè¢«æ‰§è¡Œã€‚</p><p>æ•…ä»£ç ç»“æœä¸ºï¼š 1 2 3</p><h5 id="ç¬¬å…­å±‚ï¼š"><a href="#ç¬¬å…­å±‚ï¼š" class="headerlink" title="ç¬¬å…­å±‚ï¼š"></a>ç¬¬å…­å±‚ï¼š</h5><p>åšäº†å‰é¢ä¸¤é“é¢˜ï¼Œä¸çŸ¥é“å¤§å®¶æœ‰æ²¡æœ‰ä¸€ç‚¹å›°æƒ‘ã€‚æ„Ÿè§‰æˆ‘ä¼¼ä¹æœ‰æ„å›é¿äº† thenã€catch çš„è¿”å›å€¼å³(return â€¦),è€Œä¸”ä¹Ÿæ²¡æœ‰åœ¨ thenã€catch é‡Œå†™å…·ä½“çš„å‚æ•°ã€‚å¯¼è‡´æˆ‘åœ¨ç¬¬äº”å±‚çš„ç¬¬ä¸€å¥è‡³ç†åè¨€â€œæ— è®ºæ˜¯ then æˆ–è€… catch é‡Œçš„å†…å®¹åªè¦æ­£å¸¸æ‰§è¡Œæˆ–è€…æ­£å¸¸è¿”å›â€¦â€ä¹Ÿæ²¡æœ‰å®Œå…¨ä½“ç°å‡ºæ¥ã€‚ å¤§å®¶åˆ«æ…Œï¼Œå…¶å®è¿™æ­£æ˜¯æˆ‘è¦è®²çš„ç¬¬å…­å±‚å¥—è·¯~</p><p>thenã€catch å‚æ•°çš„æ¥å¤´å…¶å®å°±æ˜¯æˆ‘åœ¨ç¬¬ä¸‰å±‚å¥—è·¯é‡Œå°±è®²è¿‡<code>â€œç´§è·ŸPromiseå®ä¾‹çš„thençš„å‚æ•°ç­‰äºresolveæ¥å—çš„å‚æ•°ï¼›ç´§è·ŸPromiseå®ä¾‹çš„catchçš„å‚æ•°ç­‰äºrejectæ¥å—çš„å‚æ•°ã€‚â€</code>ã€‚å¦‚æœ thenã€catch é‡Œçš„å›è°ƒï¼Œæ²¡æœ‰å†™è¿”å›å†…å®¹ï¼Œåˆ™ then æˆ– catch åé¢å³å°†è¢«è§¦å‘çš„ then æˆ– catch æ˜¯æ— æ³•æ¥å—åˆ°å‚æ•°çš„ï¼›è€Œå¦‚æœæœ‰è¿”å›å†…å®¹ï¼Œå³ returnâ€¦ é‚£ä¹ˆæ— è®ºè¿”å›çš„æ˜¯æ™®é€šå€¼è¿˜æ˜¯æ˜¯ Promise å®ä¾‹ï¼Œå…¶å®éƒ½ä¼šå¯¹åº”è¢«è½¬åŒ–ä¸º Promise çš„å®ä¾‹(Promise.resolve(â€¦)æˆ–è€… Promise.reject(â€¦))</p><p>ç»“åˆä»£ç å†æ¥ç†è§£ä¸€ä¸‹~</p><figure class="highlight coffeescript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><code class="hljs coffeescript"><span class="hljs-built_in">Promise</span>.reject(<span class="hljs-string">&#x27;æˆ‘æƒ³å‡ºé”™&#x27;</span>).<span class="hljs-keyword">catch</span>(<span class="hljs-function"><span class="hljs-params">(err)</span> =&gt;</span> &#123;<br>  <span class="hljs-built_in">console</span>.log(err);<br>  <span class="hljs-keyword">return</span> <span class="hljs-string">&#x27;æˆ‘ä¸æƒ³å‡ºé”™&#x27;</span>;  <span class="hljs-regexp">//</span> ä¼šè¢«è‡ªåŠ¨å°è£…æˆ<span class="hljs-keyword">return</span> <span class="hljs-built_in">Promise</span>.resolve(<span class="hljs-string">&#x27;æˆ‘ä¸æƒ³å‡ºé”™&#x27;</span>)<br>&#125;).<span class="hljs-keyword">then</span>(data =&gt; &#123;<br>  <span class="hljs-built_in">console</span>.log(data);<br>  <span class="hljs-keyword">return</span> <span class="hljs-built_in">Promise</span>.resolve(<span class="hljs-string">&#x27;æˆ‘ä¸æƒ³å‡ºé”™&#x27;</span>)<br>&#125;).<span class="hljs-keyword">then</span>(data =&gt; &#123;<br>  <span class="hljs-built_in">console</span>.log(data);<br>&#125;)<br></code></pre></td></tr></table></figure><p>ä»£ç æ‰“å°ç»“æœï¼š<br>æˆ‘æƒ³å‡ºé”™<br>æˆ‘ä¸æƒ³å‡ºé”™<br>æˆ‘ä¸æƒ³å‡ºé”™</p><h5 id="ç¬¬ä¸ƒå±‚ï¼š"><a href="#ç¬¬ä¸ƒå±‚ï¼š" class="headerlink" title="ç¬¬ä¸ƒå±‚ï¼š"></a>ç¬¬ä¸ƒå±‚ï¼š</h5><p>ç¬¬ä¸ƒå±‚å¥—è·¯ï¼Œæˆ‘æ¥è°ˆè°ˆ async/awaitã€‚ å› ä¸º Promise çš„å‡ºç°ä¸»è¦æ˜¯ä¸ºäº†è§£å†³å¼‚æ­¥çš„å›è°ƒåœ°ç‹±é—®é¢˜ã€‚å°†å™©æ¢¦èˆ¬çš„åµŒå¥—å›è°ƒå˜ä¸ºäº†ä¼˜é›…çš„ç®¡é“å¼å›è°ƒã€‚ä½†è¿™å§‹ç»ˆæ˜¯é€ƒä¸æ‰â€œå›è°ƒâ€äºŒå­—ã€‚è€Œ async/await è™½è¯´åªæ˜¯ Promise çš„è¯­æ³•ç³–ï¼Œä½†è®©ä½ â€œè„±ç¦»â€äº†å›è°ƒï¼Œæ‹¥æŠ±äº†åŒæ­¥ä»£ç ~</p><p>ä¸‹é¢æˆ‘å†åˆ†äº«å¤§å®¶äº”å¥ç»å…¸è¯­å½•~</p><blockquote><p>æ‰§è¡Œ async å‡½æ•°ï¼Œè¿”å›çš„æ˜¯ Promise å¯¹è±¡</p></blockquote><blockquote><p>await å¿…é¡»åœ¨ async åŒ…è£¹ä¹‹ä¸‹æ‰§è¡Œ</p></blockquote><blockquote><p>await ç›¸å½“äº Promise çš„ then å¹¶ä¸”åŒä¸€ä½œç”¨åŸŸä¸‹ await ä¸‹é¢çš„å†…å®¹å…¨éƒ¨ä½œä¸º then ä¸­å›è°ƒçš„å†…å®¹</p></blockquote><blockquote><p>tryâ€¦â€¦catch å¯æ•è·å¼‚å¸¸ï¼Œä»£æ›¿äº† Promise çš„ catch</p></blockquote><blockquote><p>å¼‚æ­¥ä¸­å…ˆæ‰§è¡Œå¾®ä»»åŠ¡ï¼Œå†æ‰§è¡Œå®ä»»åŠ¡</p></blockquote><p>ä¸”çœ‹ä¸‹é¢çš„ä»£ç åˆ†æï¼š</p><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><code class="hljs javascript"><span class="hljs-keyword">async</span> <span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">fn</span>(<span class="hljs-params"></span>) </span>&#123;<br>  <span class="hljs-keyword">return</span> <span class="hljs-string">&#x27;æˆ‘æ˜¯asyncå‡½æ•°&#x27;</span>;<br>&#125;<br><br><span class="hljs-built_in">console</span>.log(<span class="hljs-string">&#x27;async:&#x27;</span>, fn());<br></code></pre></td></tr></table></figure><p>æ‰§è¡Œç»“æœï¼š</p><p><img src="https://p3-juejin.byteimg.com/tos-cn-i-k3u1fbpfcp/d97ad91369b344ee8e168444253fa1b0~tplv-k3u1fbpfcp-watermark.image" alt="æˆªå±2021-06-13 ä¸‹åˆ10.23.56.png"></p><p>è¿™é‡Œçš„ fn() ç›¸å½“äº Promise.resolve(â€˜æˆ‘æ˜¯ async å‡½æ•°â€™)ï¼ŒéªŒè¯äº†ç¬¬ä¸€æ¡è¯­å½•ï¼</p><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><code class="hljs javascript">(<span class="hljs-keyword">async</span> <span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params"></span>) </span>&#123;<br>  <span class="hljs-keyword">const</span> p = <span class="hljs-built_in">Promise</span>.resolve(<span class="hljs-string">&#x27;å¸…å¾—ä¹±ä¸ƒå…«ç³Ÿ&#x27;</span>);<br>  <span class="hljs-keyword">const</span> data = <span class="hljs-keyword">await</span> p; <span class="hljs-comment">// awaitå°±ç›¸å½“äºPromise.then, æ•…dataå°±æ˜¯thençš„å‚æ•°</span><br>  <span class="hljs-built_in">console</span>.log(data);    <span class="hljs-comment">// è¿™é‡Œçš„ä»£ç ä¸ºthenä¸­å›è°ƒçš„å†…å®¹</span><br>&#125;)()<br></code></pre></td></tr></table></figure><p>ä¸Šé¢çš„è¿™æ®µä»£ç ï¼Œå¤§å®¶å¯ä»¥è¯•ç€æŠŠ<code>async</code>åˆ æ‰ï¼Œç»“æœä¸€å®šä¼šæŠ¥é”™ï¼è¿™å°±éªŒè¯äº†ç¬¬äºŒæ¡è¯­å½•ï¼ä¸Šé¢ä»£ç çš„æ³¨é‡Šç»“åˆç¬¬ä¸‰æ¡è¯­å½•ï¼Œå¤§å®¶åº”è¯¥èƒ½å¤Ÿä½“ä¼šåˆ°<code>await</code>çš„ä½œç”¨ï¼</p><p>å†çœ‹ä¸‹é¢ä¸€æ®µä»£ç ï¼š</p><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><code class="hljs javascript">(<span class="hljs-keyword">async</span> <span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params"></span>) </span>&#123;<br>  <span class="hljs-keyword">const</span> p = <span class="hljs-built_in">Promise</span>.reject(<span class="hljs-string">&#x27;err&#x27;</span>);<br>  <span class="hljs-comment">// await + try...catch ç›¸å½“äº Promise.catch</span><br>  <span class="hljs-keyword">try</span> &#123;<br>    <span class="hljs-keyword">const</span> res = <span class="hljs-keyword">await</span> p;<br>    <span class="hljs-built_in">console</span>.log(res);<br>  &#125; <span class="hljs-keyword">catch</span>(ex) &#123;  <span class="hljs-comment">// ex æ¥æºäºreject()é‡Œé¢çš„æ•°</span><br>    <span class="hljs-built_in">console</span>.error(ex);<br>  &#125;<br>&#125;)()<br></code></pre></td></tr></table></figure><p>æ‰“å°ç»“æœä¸º errï¼ŒéªŒè¯äº†ç¬¬å››æ¡è¯­å½•ã€‚</p><p>åœ¨æ­¤è¡¥å……ä¸€ç‚¹å†…å®¹ï¼š</p><ul><li>å¸¸è§çš„å¾®ä»»åŠ¡ï¼š Promiseâ€¦â€¦thenã€ async/await</li><li>å¸¸è§çš„å®ä»»åŠ¡ï¼š setTimeoutã€setInterval<blockquote><p>è€ƒè™‘è¿‡åœ¨æ–‡ç« é‡Œè°ˆè°ˆå®ä»»åŠ¡å’Œå¾®ä»»åŠ¡çš„æ‰§è¡Œæœºåˆ¶ï¼Œä½†é™äºç¯‡å¹…ä»¥åŠæœ¬ç¯‡æ–‡ç« çš„ä¾§é‡ç‚¹åœ¨äºè§£é¢˜äºæ˜¯å°±ä¸è¿‡å¤šèµ˜è¿°å…¶ä»–å†…å®¹äº†ï¼Œæœ‰å…´è¶£çš„æœ‹å‹å¯ä»¥åœ¨è¯„è®ºåŒºè®¨è®ºä¸€ä¸‹ã€‚</p></blockquote></li></ul><p>å…¶å®çœ‹åˆ°è¿™å„¿ï¼Œæ–‡ç« å¼€å§‹å‡ºçš„æ‰€æœ‰é¢˜ç›®éƒ½èƒ½å¤Ÿè§£å†³äº†ã€‚ä¸ä¿¡å°±è¯•è¯• ğŸ’ªğŸ»</p><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br></pre></td><td class="code"><pre><code class="hljs javascript">é¢˜ç›®ä¸‰:<br><span class="hljs-keyword">async</span> <span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">async1</span> (<span class="hljs-params"></span>) </span>&#123;<br>  <span class="hljs-built_in">console</span>.log(<span class="hljs-string">&#x27;async1 start&#x27;</span>);<br>  <span class="hljs-keyword">await</span> async2();<br>  <span class="hljs-built_in">console</span>.log(<span class="hljs-string">&#x27;async1 end&#x27;</span>);<br>&#125;<br><span class="hljs-keyword">async</span> <span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">async2</span> (<span class="hljs-params"></span>) </span>&#123;<br>  <span class="hljs-built_in">console</span>.log(<span class="hljs-string">&#x27;async2&#x27;</span>);<br>&#125;<br><span class="hljs-built_in">console</span>.log(<span class="hljs-string">&#x27;script start&#x27;</span>);<br><span class="hljs-built_in">setTimeout</span>(<span class="hljs-function"><span class="hljs-keyword">function</span> (<span class="hljs-params"></span>) </span>&#123;<br>  <span class="hljs-built_in">console</span>.log(<span class="hljs-string">&#x27;setTimeout&#x27;</span>);<br>&#125;, <span class="hljs-number">0</span>)<br>async1()<br><span class="hljs-keyword">new</span> <span class="hljs-built_in">Promise</span> (<span class="hljs-function"><span class="hljs-keyword">function</span> (<span class="hljs-params">resolve</span>) </span>&#123;<br>  <span class="hljs-built_in">console</span>.log(<span class="hljs-string">&#x27;promise1&#x27;</span>)<br>  resolve()<br>&#125;).then(<span class="hljs-function"><span class="hljs-keyword">function</span> (<span class="hljs-params"></span>) </span>&#123;<br>  <span class="hljs-built_in">console</span>.log(<span class="hljs-string">&#x27;promise2&#x27;</span>)<br>&#125;)<br><br><span class="hljs-built_in">console</span>.log(<span class="hljs-string">&#x27;script end&#x27;</span>)<br></code></pre></td></tr></table></figure><p>æ­¤é¢˜éœ€è¦æ³¨æ„ä¸¤ä¸ªç‚¹</p><ol><li>new Promise()å†…éƒ¨çš„å›è°ƒå‡½æ•°æ˜¯å½“æˆåŒæ­¥å‡½æ•°æ‰§è¡Œ</li><li>æ‰§è¡Œåˆ° await code æ—¶ï¼Œä¼šå…ˆæ‰§è¡Œ codeï¼Œå†æ‰§è¡Œ await</li></ol><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br></pre></td><td class="code"><pre><code class="hljs sql">ä»£ç åˆ†æï¼š<br><span class="hljs-number">1.</span> å…ˆæ‰§è¡ŒåŒæ­¥ä»£ç ã€‚<br><span class="hljs-number">2.</span> æ‰€ä»¥é¦–å…ˆæ‰§è¡Œ console.<span class="hljs-built_in">log</span>(<span class="hljs-string">&#x27;script start&#x27;</span>);<br><span class="hljs-number">3.</span> setTimeoutä¸ºå®ä»»åŠ¡ï¼Œå…ˆä¸æ‰§è¡Œ<br><span class="hljs-number">4.</span> æ‰§è¡Œasync1å‡½æ•° console.<span class="hljs-built_in">log</span>(<span class="hljs-string">&#x27;async1 start&#x27;</span>); ä»¥åŠ async2(); awaitç”±äºæ˜¯Promise.thençš„è¯­æ³•ç³–æ˜¯å¼‚æ­¥ä»£ç ï¼Œå…ˆä¸æ‰§è¡Œ<br><span class="hljs-number">5.</span> <span class="hljs-keyword">new</span> Promise() å†…éƒ¨ä»£ç è¦æ‰§è¡Œï¼Œåé¢çš„<span class="hljs-keyword">then</span>çš„å†…å®¹ä¸ºå¾®ä»»åŠ¡å…ˆä¸æ‰§è¡Œ<br><span class="hljs-number">6.</span>æ‰§è¡Œconsole.<span class="hljs-built_in">log</span>(<span class="hljs-string">&#x27;script end&#x27;</span>)<br><span class="hljs-number">7.</span>åŒæ­¥ä»£ç æ‰§è¡Œç»“æŸ<br><span class="hljs-number">8.</span>å¼€å§‹æŒ‰ä»£ç é¡ºåºæ‰§è¡Œå¾®ä»»åŠ¡<br><span class="hljs-number">9.</span>å…ˆæ‰§è¡Œ console.<span class="hljs-built_in">log</span>(<span class="hljs-string">&#x27;async1 end&#x27;</span>); å‰é¢è¯´è¿‡ï¼Œawaitä¸‹é¢çš„ä»£ç ç›¸å½“äº<span class="hljs-keyword">then</span>é‡Œå›è°ƒçš„å†…å®¹<br><span class="hljs-number">10.</span><span class="hljs-keyword">new</span> Promise.thené‡Œé¢çš„å†…å®¹ console.<span class="hljs-built_in">log</span>(<span class="hljs-string">&#x27;promise2&#x27;</span>)<br><span class="hljs-number">11.</span> æœ€åæ‰§è¡Œ å®ä»»åŠ¡ä»£ç ï¼Œå³setTimeouté‡Œçš„å†…å®¹<br><br>æ‰§è¡Œç»“æœï¼š<br>script <span class="hljs-keyword">start</span><br>async1 <span class="hljs-keyword">start</span><br>async2<br>promise1<br>script <span class="hljs-keyword">end</span><br>async1 <span class="hljs-keyword">end</span><br>promise2<br>setTimeout<br></code></pre></td></tr></table></figure><figure class="highlight coffeescript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br></pre></td><td class="code"><pre><code class="hljs coffeescript">é¢˜ç›®å››ï¼š<br><span class="hljs-built_in">setTimeout</span>(<span class="hljs-function"><span class="hljs-params">()</span> =&gt;</span> &#123;<br>  <span class="hljs-built_in">console</span>.log(<span class="hljs-string">&#x27;0&#x27;</span>);<br>&#125;, <span class="hljs-number">0</span>)<br><span class="hljs-keyword">new</span> <span class="hljs-built_in">Promise</span>(<span class="hljs-function"><span class="hljs-params">(resolve, reject)</span> =&gt;</span> &#123;<br>  <span class="hljs-built_in">console</span>.log(<span class="hljs-string">&#x27;1&#x27;</span>);<br>  resolve();<br>&#125;).<span class="hljs-keyword">then</span>(<span class="hljs-function"><span class="hljs-params">()</span> =&gt;</span> &#123;<br>  <span class="hljs-built_in">console</span>.log(<span class="hljs-string">&#x27;2&#x27;</span>);<br>  <span class="hljs-keyword">new</span> <span class="hljs-built_in">Promise</span>(<span class="hljs-function"><span class="hljs-params">(resolve, reject)</span> =&gt;</span> &#123;<br>    <span class="hljs-built_in">console</span>.log(<span class="hljs-string">&#x27;3&#x27;</span>);<br>    resolve();<br>  &#125;).<span class="hljs-keyword">then</span>(<span class="hljs-function"><span class="hljs-params">()</span> =&gt;</span> &#123;     <span class="hljs-regexp">//</span> ğŸ“Œ<br>    <span class="hljs-built_in">console</span>.log(<span class="hljs-string">&#x27;4&#x27;</span>);<br>  &#125;).<span class="hljs-keyword">then</span>(<span class="hljs-function"><span class="hljs-params">()</span> =&gt;</span> &#123;<br>    <span class="hljs-built_in">console</span>.log(<span class="hljs-string">&#x27;5&#x27;</span>);<br>  &#125;)<br>&#125;).<span class="hljs-keyword">then</span>(<span class="hljs-function"><span class="hljs-params">()</span> =&gt;</span> &#123;<br>  <span class="hljs-built_in">console</span>.log(<span class="hljs-string">&#x27;6&#x27;</span>);   <span class="hljs-regexp">//</span> ğŸ“Œ<br>&#125;)<br><br><span class="hljs-keyword">new</span> <span class="hljs-built_in">Promise</span>(<span class="hljs-function"><span class="hljs-params">(resolve, reject)</span> =&gt;</span> &#123;<br>  <span class="hljs-built_in">console</span>.log(<span class="hljs-string">&#x27;7&#x27;</span>);<br>  resolve()<br>&#125;).<span class="hljs-keyword">then</span>(<span class="hljs-function"><span class="hljs-params">()</span> =&gt;</span> &#123;<br>  <span class="hljs-built_in">console</span>.log(<span class="hljs-string">&#x27;8&#x27;</span>);<br>&#125;)<br></code></pre></td></tr></table></figure><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br></pre></td><td class="code"><pre><code class="hljs sql">ä»£ç åˆ†æï¼š<br><span class="hljs-number">1.</span>å…ˆæ‰§è¡ŒåŒæ­¥ä»£ç <br><span class="hljs-number">2.</span>setTimeout ä¸ºå®ä»»åŠ¡ï¼Œå…ˆä¸æ‰§è¡Œ<br><span class="hljs-number">3.</span><span class="hljs-keyword">new</span> Promiseé‡Œçš„ä»£ç ä½œä¸ºåŒæ­¥ä»£ç ï¼Œè¦æ‰§è¡Œ console.<span class="hljs-built_in">log</span>(<span class="hljs-string">&#x27;1&#x27;</span>); è€Œ<span class="hljs-keyword">then</span>ä½œä¸ºå¾®ä»»åŠ¡ï¼Œå…ˆä¸æ‰§è¡Œ<br><span class="hljs-number">4.</span>åˆæ˜¯ä¸€ä¸ª<span class="hljs-keyword">new</span> Promise,æ‰€ä»¥å’Œç¬¬ä¸‰æ­¥åŒç†ã€‚åªæ‰§è¡Œ console.<span class="hljs-built_in">log</span>(<span class="hljs-string">&#x27;7&#x27;</span>);<br><span class="hljs-number">5.</span>å¼€å§‹æ‰§è¡Œå¼‚æ­¥ä»£ç <br><span class="hljs-number">6.</span>æ‰§è¡Œç¬¬ä¸€ä¸ª<span class="hljs-keyword">new</span> Promiseé‡Œçš„<span class="hljs-keyword">then</span> å³console.<span class="hljs-built_in">log</span>(<span class="hljs-string">&#x27;2&#x27;</span>);ä»¥åŠ<span class="hljs-keyword">new</span> Promiseçš„åŒæ­¥ä»£ç  console.<span class="hljs-built_in">log</span>(<span class="hljs-string">&#x27;3&#x27;</span>);<br><span class="hljs-number">7.</span>è¿™æ­¥æœ‰ç‚¹æ„æ€ï¼Œè¿™é‡Œä¸æ˜¯æ‰§è¡Œconsole.<span class="hljs-built_in">log</span>(<span class="hljs-string">&#x27;4&#x27;</span>); è€Œæ˜¯æ‰§è¡Œconsole.<span class="hljs-built_in">log</span>(<span class="hljs-string">&#x27;8&#x27;</span>);<br><span class="hljs-number">8.</span>æ³¨é‡Šä¸ºğŸ“Œçš„ä¸¤ä¸ª<span class="hljs-keyword">then</span>æ˜¯åŒå±‚çº§çš„ï¼Œæ‰€ä»¥æŒ‰ç…§æ‰§è¡Œé¡ºåºæ¥æ‰“å°<br><span class="hljs-number">9.</span>æ‰§è¡Œç¬¬ä¸‰ä¸ªå±‚çº§çš„<span class="hljs-keyword">then</span>ï¼Œæ‰€æœ‰å¾®ä»»åŠ¡ä»£ç å®Œæˆ<br><span class="hljs-number">10.</span>æ‰§è¡Œå®ä»»åŠ¡ä»£ç ï¼Œå³console.<span class="hljs-built_in">log</span>(<span class="hljs-string">&#x27;0&#x27;</span>);<br><br>ä»£ç ç»“æœï¼š<br><span class="hljs-number">1</span><br><span class="hljs-number">7</span><br><span class="hljs-number">2</span><br><span class="hljs-number">3</span><br><span class="hljs-number">8</span><br><span class="hljs-number">4</span><br><span class="hljs-number">6</span><br><span class="hljs-number">5</span><br><span class="hljs-number">0</span><br></code></pre></td></tr></table></figure><p>è¯´æœ‰åƒå±‚é¥¼å¥—è·¯ï¼Œå…¶å®åªæœ‰ 7 å±‚å¥—è·¯ï¼Œä½†è¿™æ¯ä¸€å±‚å¥—è·¯éƒ½æ˜¯æˆ‘å¯¹äº Promiseã€async/await çš„æ„Ÿæ‚Ÿï¼Œæœ‰äº›å†…å®¹å¹¶æœªç»†è®²ï¼Œæ¯”å¦‚å¾®ä»»åŠ¡ã€å®ä»»åŠ¡ä¸ DOM ä¹‹é—´çš„æ‰§è¡Œé¡ºåºè¿™ç§ç›¸å¯¹åº•å±‚çš„å†…å®¹æœ¬æ–‡å¹¶æœªè°ˆåŠï¼Œæ¯•ç«Ÿè¿™ç¯‡æ–‡ç« çš„ä¾§é‡ç‚¹æ˜¯åœ¨è§£å†³ Promiseã€async/await æ‰§è¡Œé¡ºåºç±»å‹é¢˜ã€‚æœ¬æ–‡ä¹Ÿå¯èƒ½æœ‰å†…å®¹é”™è¯¯æˆ–é€»è¾‘é”™è¯¯ï¼Œä¹Ÿè¯·å¤§å®¶å¤šå¤šåŒ…æ¶µï¼Œå¤šå¤šæŒ‡å‡ºï¼Œè°¢è°¢ï¼ï¼</p><p>å¥½äº†ï¼Œå¤§åŠŸå·²å‘Šæˆï¼æƒ³å¿…é€šè¿‡è¿™äº›é¢˜ï¼Œå¤§å®¶å·²ç»é¢†æ‚Ÿåˆ°äº†è§£å†³æ­¤ç±»é¢˜å‹çš„å¥¥ä¹‰ï¼</p><head>  ..  <script src="//cdn.jsdelivr.net/npm/@waline/client"></script>  ...</head><body>  ...  <div id="waline"></div>  <script>    Waline({      el: '#waline',       avatar: 'monsterid',      serverURL: 'https://blog-api-9sizcti78-bruce-shuai.vercel.app/',    });  </script></body>]]></content>
    
    
    <categories>
      
      <category>JavaScript</category>
      
    </categories>
    
    
    <tags>
      
      <tag>å‰ç«¯</tag>
      
    </tags>
    
  </entry>
  
  
  
  <entry>
    <title>æœ‰æ•ˆæ‹¬å·é—®é¢˜</title>
    <link href="/2021/10/07/%E6%9C%89%E6%95%88%E6%8B%AC%E5%8F%B7%E9%97%AE%E9%A2%98/"/>
    <url>/2021/10/07/%E6%9C%89%E6%95%88%E6%8B%AC%E5%8F%B7%E9%97%AE%E9%A2%98/</url>
    
    <content type="html"><![CDATA[<figure class="highlight awk"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br></pre></td><td class="code"><pre><code class="hljs awk">/**<br> * é¢˜ç›®æè¿°ï¼šç»™å®šä¸€ä¸ªåªåŒ…æ‹¬<span class="hljs-string">&#x27;(&#x27;</span>, <span class="hljs-string">&#x27;)&#x27;</span>, <span class="hljs-string">&#x27;&#123;&#x27;</span>, <span class="hljs-string">&#x27;&#125;&#x27;</span>, <span class="hljs-string">&#x27;[&#x27;</span>, <span class="hljs-string">&#x27;]&#x27;</span>çš„å­—ç¬¦ä¸²,åˆ¤æ–­å­—ç¬¦ä¸²æ˜¯å¦æœ‰æ•ˆ<br> * <br> * è®°ä½ä¸€ä¸ªè§„å¾‹ï¼š æ‹¬å·æˆç«‹ æ„å‘³ç€ å¯¹ç§°æ€§<br> */<br><br><span class="hljs-regexp">//</span> æ‹¬å·é—®é¢˜ï¼Œæˆ‘ä»¬ä¸€èˆ¬é¦–é€‰æ ˆæ¥åš    ----&gt;   å¯¹ç§°æ€§<br><br><span class="hljs-regexp">//</span> ç”¨ä¸€ä¸ªmapæ¥ç»´æŠ¤å·¦æ‹¬å·å’Œå³æ‹¬å·çš„å¯¹åº”å…³ç³»<br><span class="hljs-regexp">//</span> map å…³ç³»çœŸçš„éå¸¸çš„å¥½ç”¨<br><span class="hljs-regexp">//</span> const leftToRight = &#123;<br><span class="hljs-regexp">//</span>   <span class="hljs-string">&quot;(&quot;</span>:<span class="hljs-string">&quot;)&quot;</span>,<br><span class="hljs-regexp">//</span>   <span class="hljs-string">&quot;&#123;&quot;</span>:<span class="hljs-string">&quot;&#125;&quot;</span>,<br><span class="hljs-regexp">//</span>   <span class="hljs-string">&quot;[&quot;</span>:<span class="hljs-string">&quot;]&quot;</span><br><span class="hljs-regexp">//</span> &#125;<br><br><span class="hljs-regexp">//</span> /**<br><span class="hljs-regexp">//</span>  * @param &#123;string&#125; s<br><span class="hljs-regexp">//</span>  * @return &#123;boolean&#125;<br><span class="hljs-regexp">//</span>  */<br><br><span class="hljs-regexp">//</span> <span class="hljs-regexp">//</span> æœ‰äº›ç»†èŠ‚ æˆ‘<br><span class="hljs-regexp">//</span> const isValid = <span class="hljs-keyword">function</span>(s) &#123;<br><span class="hljs-regexp">//</span>   <span class="hljs-regexp">//</span> ç»“åˆé¢˜æ„ï¼Œç©ºå­—ç¬¦ä¸²æ— æ¡ä»¶åˆ¤æ–­ä¸º true<br><span class="hljs-regexp">//</span>   <span class="hljs-keyword">if</span> (!s) &#123;<br><span class="hljs-regexp">//</span>     return true;<br><span class="hljs-regexp">//</span>   &#125;<br><span class="hljs-regexp">//</span>   <span class="hljs-regexp">//</span> åˆå§‹åŒ– stack æ•°ç»„<br><span class="hljs-regexp">//</span>   const stack = [];<br><span class="hljs-regexp">//</span>   <span class="hljs-keyword">for</span> (let i = <span class="hljs-number">0</span>; i &lt; s.length; i++) &#123;<br><span class="hljs-regexp">//</span>     <span class="hljs-keyword">if</span> (s[i] === <span class="hljs-string">&#x27;(&#x27;</span> || s[i] === <span class="hljs-string">&#x27;&#123;&#x27;</span> || s[i] === <span class="hljs-string">&#x27;[&#x27;</span>) &#123;<br><span class="hljs-regexp">//</span>       stack.push(leftToRight[s[i]])<br><span class="hljs-regexp">//</span>     &#125; <span class="hljs-keyword">else</span> &#123;<br><span class="hljs-regexp">//</span>       <span class="hljs-regexp">//</span> ä½†æ˜¯äººå®¶å†™çš„æ˜¯!stack.length || stack.pop() !== ch  å¥½å¥‡æ€ª...<br><span class="hljs-regexp">//</span>       <span class="hljs-keyword">if</span> (stack.pop() !== s[i]) &#123;<br><span class="hljs-regexp">//</span>         return false;<br><span class="hljs-regexp">//</span>       &#125;<br><span class="hljs-regexp">//</span>     &#125;<br><span class="hljs-regexp">//</span>   &#125;<br><span class="hljs-regexp">//</span>   <span class="hljs-regexp">//</span> è‹¥æ‰€æœ‰çš„æ‹¬å·éƒ½èƒ½é…å¯¹æˆåŠŸï¼Œé‚£ä¹ˆæœ€åæ ˆåº”è¯¥æ˜¯ç©ºçš„<br><span class="hljs-regexp">//</span>   <span class="hljs-regexp">//</span> return !stack.length;<br><br><span class="hljs-regexp">//</span>   return true;<br><span class="hljs-regexp">//</span> &#125;<br><br><br><br><span class="hljs-regexp">//</span> æ³¨æ„ï¼š ))))(((( è¿™ç§æ˜¯é”™è¯¯çš„ã€‚å·¦æ‹¬å·å¿…é¡»ä»¥æ­£ç¡®çš„é¡ºåºé—­åˆ<br><br><span class="hljs-regexp">//</span> å¯¹è±¡æ˜ å°„å¤§æ³• ----&gt;  æ³¨æ„ï¼å˜é‡ååƒä¸‡æé”™ä¸èƒ½å‡ºé”™, æœ‰æ—¶è¦å¥½å¥½æ£€æŸ¥æ£€æŸ¥è‡ªå·±çš„å˜é‡å...<br>const leftToRight = &#123;<br>  <span class="hljs-string">&quot;&#123;&quot;</span>:<span class="hljs-string">&quot;&#125;&quot;</span>,<br>  <span class="hljs-string">&quot;(&quot;</span>:<span class="hljs-string">&quot;)&quot;</span>,<br>  <span class="hljs-string">&quot;[&quot;</span>:<span class="hljs-string">&quot;]&quot;</span><br>&#125;<br><br><br><span class="hljs-regexp">//</span> æˆ‘è‡ªå·±æƒ³åˆ°ä¸€ä¸ªæ–¹æ³•ã€‚è®¾ç½®ä¸¤ä¸ªæ ˆã€‚ä¸€ä¸ªæ ˆæ”¾å…¥å·¦ä¾§ç¬¦å·çš„æ˜ å°„ã€‚  ä¸€ä¸ªæ ˆæ”¾å…¥å³ä¾§ç¬¦å·ã€‚ ä¸¤ä¸ªæ ˆè¿›è¡Œä¸€ä¸€å¯¹æ¯”<br>const isValid = (str) =&gt; &#123;<br>  const stack = [];<br>  <span class="hljs-regexp">//</span> æ•°ç»„ç¼“å­˜<br>  let len = str.length;<br><br>  <span class="hljs-keyword">for</span> (let i = <span class="hljs-number">0</span>; i &lt; len; i++) &#123;<br>    <span class="hljs-keyword">if</span> (str[i] === <span class="hljs-string">&#x27;&#123;&#x27;</span> || str[i] === <span class="hljs-string">&#x27;[&#x27;</span> || str[i] === <span class="hljs-string">&#x27;(&#x27;</span>) &#123;<br>      stack.push(leftToRight[str[i]]);<br>    &#125; <span class="hljs-keyword">else</span> <span class="hljs-keyword">if</span> (stack.length !== <span class="hljs-number">0</span> &amp;&amp; str[i] === stack[stack.length - <span class="hljs-number">1</span>]) &#123;<br>      stack.pop();<br>    &#125; <span class="hljs-keyword">else</span> <span class="hljs-keyword">if</span> (stack.length === <span class="hljs-number">0</span>) &#123;<br>      return false;<br>    &#125;<br>  &#125;<br>  return stack.length === <span class="hljs-number">0</span>;<br>&#125;<br><br>console.log(<span class="hljs-string">&#x27;test&#x27;</span>, isValid(<span class="hljs-string">&#x27;()[]&#123;&#125;&#x27;</span>));<br></code></pre></td></tr></table></figure><head>  ..  <script src="//cdn.jsdelivr.net/npm/@waline/client"></script>  ...</head><body>  ...  <div id="waline"></div>  <script>    Waline({      el: '#waline',       avatar: 'monsterid',      serverURL: 'https://blog-api-9sizcti78-bruce-shuai.vercel.app/',    });  </script></body>]]></content>
    
    
    <categories>
      
      <category>æ•°æ®ç»“æ„ä¸ç®—æ³•</category>
      
      <category>æ ˆç±»ç›¸å…³é—®é¢˜</category>
      
    </categories>
    
    
    <tags>
      
      <tag>ç®—æ³•</tag>
      
    </tags>
    
  </entry>
  
  
  
  <entry>
    <title>å¼€å§‹æˆ‘çš„ä¸ªäººåšå®¢ä¹‹æ—…å•¦</title>
    <link href="/2021/10/07/%E5%BC%80%E5%A7%8B%E6%88%91%E7%9A%84%E4%B8%AA%E4%BA%BA%E5%8D%9A%E5%AE%A2%E4%B9%8B%E6%97%85%E5%95%A6/"/>
    <url>/2021/10/07/%E5%BC%80%E5%A7%8B%E6%88%91%E7%9A%84%E4%B8%AA%E4%BA%BA%E5%8D%9A%E5%AE%A2%E4%B9%8B%E6%97%85%E5%95%A6/</url>
    
    <content type="html"><![CDATA[<p>è¿™ç¯‡åšå®¢åªæ˜¯ç”¨æ¥æµ‹è¯•ä¸€ä¸‹ç½‘ç«™ å“ˆå“ˆå“ˆ<br>ç¥ç¦çœ‹è§è¿™ç¯‡åšå®¢çš„ä½  æ°¸è¿œå¿«ä¹å“¦!</p><head>  ..  <script src="//cdn.jsdelivr.net/npm/@waline/client"></script>  ...</head><body>  ...  <div id="waline"></div>  <script>    Waline({      el: '#waline',      serverURL: 'https://blog-api-9sizcti78-bruce-shuai.vercel.app/',    });  </script></body>]]></content>
    
    
    
    <tags>
      
      <tag>ç”Ÿæ´»</tag>
      
    </tags>
    
  </entry>
  
  
  
  <entry>
    <title>Hello World</title>
    <link href="/2021/10/06/hello-world/"/>
    <url>/2021/10/06/hello-world/</url>
    
    <content type="html"><![CDATA[<p>Welcome to <a href="https://hexo.io/">Hexo</a>! This is your very first post. Check <a href="https://hexo.io/docs/">documentation</a> for more info. If you get any problems when using Hexo, you can find the answer in <a href="https://hexo.io/docs/troubleshooting.html">troubleshooting</a> or you can ask me on <a href="https://github.com/hexojs/hexo/issues">GitHub</a>.</p><h2 id="Quick-Start"><a href="#Quick-Start" class="headerlink" title="Quick Start"></a>Quick Start</h2><h3 id="Create-a-new-post"><a href="#Create-a-new-post" class="headerlink" title="Create a new post"></a>Create a new post</h3><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs bash">$ hexo new <span class="hljs-string">&quot;My New Post&quot;</span><br></code></pre></td></tr></table></figure><p>More info: <a href="https://hexo.io/docs/writing.html">Writing</a></p><h3 id="Run-server"><a href="#Run-server" class="headerlink" title="Run server"></a>Run server</h3><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs bash">$ hexo server<br></code></pre></td></tr></table></figure><p>More info: <a href="https://hexo.io/docs/server.html">Server</a></p><h3 id="Generate-static-files"><a href="#Generate-static-files" class="headerlink" title="Generate static files"></a>Generate static files</h3><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs bash">$ hexo generate<br></code></pre></td></tr></table></figure><p>More info: <a href="https://hexo.io/docs/generating.html">Generating</a></p><h3 id="Deploy-to-remote-sites"><a href="#Deploy-to-remote-sites" class="headerlink" title="Deploy to remote sites"></a>Deploy to remote sites</h3><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs bash">$ hexo deploy<br></code></pre></td></tr></table></figure><p>More info: <a href="https://hexo.io/docs/one-command-deployment.html">Deployment</a></p>]]></content>
    
    
    
  </entry>
  
  
  
  
</search>
